# GASã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸

**æœ€çµ‚æ›´æ–°**: 2025-10-31
**ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: `/Users/ryuryu/gas-backup-complete-20251031_142529.tar.gz`

---

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³](#ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³)
3. [ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ—](#ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ—)
4. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
5. [å¤‰æ›´å½±éŸ¿ç¯„å›²](#å¤‰æ›´å½±éŸ¿ç¯„å›²)
6. [å®‰å…¨ãªå¤‰æ›´æ‰‹é †](#å®‰å…¨ãªå¤‰æ›´æ‰‹é †)

---

## ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### å…¨ä½“æ§‹é€ 

```
å˜ä¸€GASãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆãƒ¢ãƒãƒªã‚·ãƒƒã‚¯æ§‹é€ ï¼‰
â”œâ”€â”€ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆ3ã‚·ã‚¹ãƒ†ãƒ ç‹¬ç«‹ï¼‰
â”‚   â”œâ”€â”€ franchise-register     â†’ åŠ ç›Ÿåº—ç™»éŒ²
â”‚   â”œâ”€â”€ admin-dashboard        â†’ ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â””â”€â”€ franchise-dashboard    â†’ åŠ ç›Ÿåº—ãƒãƒ¼ã‚¿ãƒ«
â”‚
â””â”€â”€ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆå˜ä¸€GASï¼‰
    â”œâ”€â”€ main.js               â†’ ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
    â”œâ”€â”€ systems/
    â”‚   â”œâ”€â”€ franchise/        â†’ ç™»éŒ²ã‚·ã‚¹ãƒ†ãƒ 
    â”‚   â”œâ”€â”€ merchant/         â†’ åŠ ç›Ÿåº—ã‚·ã‚¹ãƒ†ãƒ 
    â”‚   â”œâ”€â”€ admin/            â†’ ç®¡ç†è€…ã‚·ã‚¹ãƒ†ãƒ 
    â”‚   â””â”€â”€ ai/               â†’ AIæ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ 
    â””â”€â”€ shared/
        â””â”€â”€ DataLayer.js      â†’ çµ±ä¸€ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤
```

### ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢

- **Spreadsheet**: `åŠ ç›Ÿåº—ç™»éŒ²ç®¡ç†`ï¼ˆå…¨ã‚·ã‚¹ãƒ†ãƒ å…±æœ‰ï¼‰
- **Google Drive**: `ãã‚‰ã¹ã‚‹åŠ ç›Ÿåº—ã‚·ã‚¹ãƒ†ãƒ `ï¼ˆID: 16hFdS2Vnq1cAwR00UbiP-a3p5yVh6o7gï¼‰

---

## ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆç‰©ç†çš„åˆ†é›¢ï¼‰                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ franchise-   â”‚ admin-       â”‚ franchise-                    â”‚
â”‚ register     â”‚ dashboard    â”‚ dashboard                     â”‚
â”‚              â”‚              â”‚                               â”‚
â”‚ ãƒ»ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ   â”‚ ãƒ»ç”³è«‹ç®¡ç†    â”‚ ãƒ»ãƒ­ã‚°ã‚¤ãƒ³/ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰        â”‚
â”‚ ãƒ»AIæ¤œç´¢      â”‚ ãƒ»æ‰¿èª/å´ä¸‹   â”‚ ãƒ»ä¼šç¤¾æƒ…å ±ç·¨é›†                 â”‚
â”‚              â”‚ ãƒ»åŠ ç›Ÿåº—ç®¡ç†  â”‚ ãƒ»ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ GAS_URL      â”‚ GAS_URL          â”‚ GAS_URL
       â”‚              â”‚                  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚     å˜ä¸€GASãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆmain.jsï¼‰          â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚ doGet/doPost â†’ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°                 â”‚
       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†“        â†“        â†“        â†“
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”
       â”‚Franchiseâ”‚ â”‚Merchantâ”‚ â”‚Admin â”‚ â”‚AI   â”‚
       â”‚System   â”‚ â”‚System â”‚ â”‚Systemâ”‚ â”‚Searchâ”‚
       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜
             â”‚         â”‚        â”‚       â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚     Google Spreadsheetï¼ˆå…±æœ‰ãƒ‡ãƒ¼ã‚¿ï¼‰        â”‚
       â”‚  åŠ ç›Ÿåº—ç™»éŒ²ç®¡ç†ï¼ˆå…¨ã‚·ã‚¹ãƒ†ãƒ ãŒèª­ã¿æ›¸ãï¼‰        â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ—

### ğŸ”´ é‡è¦ï¼šã‚·ã‚¹ãƒ†ãƒ é–“ã®ä¾å­˜é–¢ä¿‚

| å¤‰æ›´å¯¾è±¡ | å½±éŸ¿ã‚’å—ã‘ã‚‹ã‚·ã‚¹ãƒ†ãƒ  | ç†ç”± | ãƒ†ã‚¹ãƒˆå¿…é ˆ |
|---------|-------------------|------|-----------|
| **FranchiseSystem.js** | MerchantSystem, AdminSystem | ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå…±æœ‰ | âœ… merchant-test, admin-test |
| **MerchantSystem.js** | franchise-dashboard | èª­ã¿å–ã‚Šå°‚ç”¨API | âœ… merchant-test |
| **AdminSystem.js** | admin-dashboard | ç®¡ç†è€…æ©Ÿèƒ½API | âœ… admin-test |
| **AISearchSystem.gs** | franchise-register | AIæ¤œç´¢æ©Ÿèƒ½ | âœ… ai-test |
| **DataLayer.js** | å…¨ã‚·ã‚¹ãƒ†ãƒ  | ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹çµ±ä¸€å±¤ | âœ… integration-test |
| **Script Properties** | å…¨ã‚·ã‚¹ãƒ†ãƒ  | DRIVE_ROOT_FOLDER_IDç­‰ | âœ… integration-test |
| **Deploymentæ›´æ–°** | å…¨ã‚·ã‚¹ãƒ†ãƒ  | å…¨env-loader.jsæ›´æ–°å¿…é ˆ | âœ… integration-test |

### ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¾å­˜

```javascript
// FranchiseSystem.jsï¼ˆæ›¸ãè¾¼ã¿ï¼‰
rowData = [
  companyName,          // ä¼šç¤¾å
  branchAddresses,      // æ”¯åº—ä½æ‰€ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰
  selectedAreas.cities, // å¯¾å¿œå¸‚åŒºç”ºæ‘
  qualifications        // ä¿æœ‰è³‡æ ¼
  // ...
]

// â¬‡ï¸ Spreadsheetã«ä¿å­˜

// MerchantSystem.jsï¼ˆèª­ã¿å–ã‚Šï¼‰
merchantData = {
  'ä¼šç¤¾å': row[2],
  'æ”¯åº—ä½æ‰€': row[15],      // â† FranchiseSystemã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ä¾å­˜
  'å¯¾å¿œå¸‚åŒºç”ºæ‘': row[33],   // â† åœ§ç¸®ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•å±•é–‹ãŒå¿…é ˆ
  'ä¿æœ‰è³‡æ ¼': row[37]
}
```

**âš ï¸ å±é™ºãªå¤‰æ›´ä¾‹:**
```javascript
// FranchiseSystem.jsã§åœ§ç¸®ã‚’å‰Šé™¤
branchAddresses = companyInfo.branches.map(b => b.address).join('ã€');

// â†“ MerchantSystem.jsãŒæ—§åœ§ç¸®ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã‚ãªã„
// â†“ merchant-portalã§è¡¨ç¤ºã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ

// å¯¾ç­–: MerchantSystem.jsã«è‡ªå‹•å±•é–‹æ©Ÿèƒ½ã‚’è¿½åŠ ï¼ˆå¾Œæ–¹äº’æ›æ€§ï¼‰
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### 1. ç™»éŒ²ãƒ•ãƒ­ãƒ¼ï¼ˆfranchise-register â†’ Spreadsheetï¼‰

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›
  â†“
franchise-registerï¼ˆãƒ•ãƒ­ãƒ³ãƒˆï¼‰
  â†“
doPost(action: 'submitRegistration')
  â†“
FranchiseSystem.handlePost()
  â†“
â”œâ”€ AIæ¤œç´¢ï¼ˆä¼šç¤¾æƒ…å ±è‡ªå‹•å–å¾—ï¼‰
â”œâ”€ ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
â””â”€ Spreadsheetæ›¸ãè¾¼ã¿
  â†“
Slackã«é€šçŸ¥
```

### 2. æ‰¿èªãƒ•ãƒ­ãƒ¼ï¼ˆadmin-dashboard â†’ Spreadsheetï¼‰

```
ç®¡ç†è€…æ“ä½œ
  â†“
admin-dashboardï¼ˆãƒ•ãƒ­ãƒ³ãƒˆï¼‰
  â†“
doPost(action: 'approveRegistration')
  â†“
AdminSystem.handlePost()
  â†“
â”œâ”€ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°ï¼ˆæ‰¿èªæ¸ˆã¿ï¼‰
â”œâ”€ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ
â””â”€ åˆå›ãƒ­ã‚°ã‚¤ãƒ³URLç”Ÿæˆ
  â†“
Spreadsheetæ›´æ–°
  â†“
åŠ ç›Ÿåº—ã«ãƒ¡ãƒ¼ãƒ«é€ä¿¡
```

### 3. ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ•ãƒ­ãƒ¼ï¼ˆfranchise-dashboardï¼‰

```
åŠ ç›Ÿåº—ãƒ¦ãƒ¼ã‚¶ãƒ¼
  â†“
first-login.html or index.html
  â†“
doGet(action: 'verifyLogin')
  â†“
MerchantSystem.handle()
  â†“
â”œâ”€ èªè¨¼ãƒã‚§ãƒƒã‚¯
â”œâ”€ Spreadsheetã‹ã‚‰ãƒ‡ãƒ¼ã‚¿èª­ã¿å–ã‚Š
â””â”€ è‡ªå‹•å±•é–‹ï¼ˆåœ§ç¸®ãƒ‡ãƒ¼ã‚¿å¯¾å¿œï¼‰
  â†“
JSONPãƒ¬ã‚¹ãƒãƒ³ã‚¹
  â†“
ãƒ•ãƒ­ãƒ³ãƒˆè¡¨ç¤ºæ›´æ–°
```

### 4. ãƒ‡ãƒ¼ã‚¿ç·¨é›†ãƒ»ä¿å­˜ãƒ•ãƒ­ãƒ¼

```
åŠ ç›Ÿåº—ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†
  â†“
franchise-dashboardï¼ˆç·¨é›†ãƒ¢ãƒ¼ãƒ‰ï¼‰
  â†“
doPost(action: 'updateMerchantData')
  â†“
AdminSystem.handlePost()
  â†“
Spreadsheetæ›´æ–°ï¼ˆè©²å½“è¡Œã®ç‰¹å®šåˆ—ï¼‰
  â†“
æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹
  â†“
window.merchantDataæ›´æ–°ï¼ˆå³æ™‚ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰
```

---

## å¤‰æ›´å½±éŸ¿ç¯„å›²

### ã‚±ãƒ¼ã‚¹1: FranchiseSystem.jsã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›´

**å¤‰æ›´ä¾‹**: `compressLongText()` ã®å‰Šé™¤

```javascript
// å¤‰æ›´å‰
branchAddresses = compressLongText(branches.map(b => b.address).join('ã€'));

// å¤‰æ›´å¾Œ
branchAddresses = branches.map(b => b.address).join('ã€');
```

**å½±éŸ¿ç¯„å›²**:
- âœ… FranchiseSystem.js: æ–°è¦ç™»éŒ²ã¯OK
- âŒ MerchantSystem.js: æ—§ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿å–ã‚Šã‚¨ãƒ©ãƒ¼
- âŒ franchise-dashboard: è¡¨ç¤ºãŒç©ºç™½ã¾ãŸã¯"ã€ã€ã€ã€"

**å¿…é ˆå¯¾å¿œ**:
1. MerchantSystem.jsã«è‡ªå‹•å±•é–‹ãƒ­ã‚¸ãƒƒã‚¯è¿½åŠ 
2. merchant-testã§æ—§ãƒ‡ãƒ¼ã‚¿ã¨æ–°ãƒ‡ãƒ¼ã‚¿ã®ä¸¡æ–¹ã‚’ãƒ†ã‚¹ãƒˆ
3. å…¨env-loader.jsæ›´æ–°ï¼ˆæ–°ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆï¼‰

**ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰**:
```bash
npm run test:merchant      # åŠ ç›Ÿåº—ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ
npm run test:integration   # å…¨ã‚·ã‚¹ãƒ†ãƒ çµ±åˆãƒ†ã‚¹ãƒˆ
```

### ã‚±ãƒ¼ã‚¹2: Script Propertieså¤‰æ›´

**å¤‰æ›´ä¾‹**: `DRIVE_ROOT_FOLDER_ID` ã®å¤‰æ›´

**å½±éŸ¿ç¯„å›²**:
- âŒ å…¨ã‚·ã‚¹ãƒ†ãƒ : ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸å¯
- âŒ franchise-dashboard: mainVisualã€photoGalleryã€constructionExamples

**å¿…é ˆå¯¾å¿œ**:
1. æ–°Driveãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ
2. Script Propertiesæ›´æ–°
3. æ–°ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆä½œæˆï¼ˆV1470ç­‰ï¼‰
4. å…¨env-loader.jsæ›´æ–°
5. integration-testå®Ÿè¡Œ

### ã‚±ãƒ¼ã‚¹3: Deploymentæ›´æ–°

**å¤‰æ›´ä¾‹**: V1469 â†’ V1470

**å½±éŸ¿ç¯„å›²**:
- âŒ å…¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: å¤ã„GAS_URLã‚’ä½¿ç”¨

**å¿…é ˆå¯¾å¿œ**:
```bash
# 1. æ–°ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆä½œæˆ
clasp deploy --description "V1470: ..."

# 2. å…¨env-loader.jsæ›´æ–°
node update-all-to-v1470.js

# 3. FTPã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
node upload-all-v1470.js

# 4. ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ç¢ºèª
```

---

## å®‰å…¨ãªå¤‰æ›´æ‰‹é †

### ğŸ›¡ï¸ åŸºæœ¬ãƒ«ãƒ¼ãƒ«

1. **å¤‰æ›´å‰**: å¿…ãšå½±éŸ¿ç¯„å›²ã‚’ç¢ºèª
2. **å¤‰æ›´ä¸­**: DataLayerã‚’çµŒç”±ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹
3. **å¤‰æ›´å¾Œ**: çµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
4. **ãƒ‡ãƒ—ãƒ­ã‚¤å‰**: å…¨env-loader.jsã®æ›´æ–°ç¢ºèª

### æ‰‹é †1: å¤‰æ›´å½±éŸ¿ãƒã‚§ãƒƒã‚¯

```bash
# å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«ã®å½±éŸ¿ç¯„å›²ã‚’è‡ªå‹•ãƒã‚§ãƒƒã‚¯
node gas/scripts/check-impact.js FranchiseSystem.js

# å‡ºåŠ›ä¾‹:
# âš ï¸  å½±éŸ¿ç¯„å›²:
#   - MerchantSystem.js
#   - AdminSystem.js
#
# âœ… æ¨å¥¨ãƒ†ã‚¹ãƒˆ:
#   - npm run test:merchant
#   - npm run test:admin
#   - npm run test:integration
```

### æ‰‹é †2: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ

```bash
# ã‚·ã‚¹ãƒ†ãƒ å€‹åˆ¥ãƒ†ã‚¹ãƒˆ
npm run test:franchise    # ç™»éŒ²ã‚·ã‚¹ãƒ†ãƒ 
npm run test:merchant     # åŠ ç›Ÿåº—ã‚·ã‚¹ãƒ†ãƒ 
npm run test:admin        # ç®¡ç†è€…ã‚·ã‚¹ãƒ†ãƒ 
npm run test:ai           # AIæ¤œç´¢

# çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆå…¨ã‚·ã‚¹ãƒ†ãƒ ï¼‰
npm run test:integration
```

### æ‰‹é †3: å®‰å…¨ãªãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# è‡ªå‹•åŒ–ã•ã‚ŒãŸãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
npm run deploy:safe

# å†…éƒ¨å‹•ä½œ:
# 1. çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
# 2. clasp push
# 3. æ–°ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆä½œæˆ
# 4. å…¨env-loader.jsæ›´æ–°
# 5. FTPã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
# 6. ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†é€šçŸ¥
```

---

## ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ãƒã‚¤ãƒ³ãƒˆ

### ğŸš¨ è‡ªå‹•æ¤œçŸ¥ã•ã‚Œã‚‹å•é¡Œ

| å•é¡Œ | æ¤œçŸ¥ã‚¿ã‚¤ãƒŸãƒ³ã‚° | å¯¾å¿œ |
|-----|-------------|-----|
| ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¸ä¸€è‡´ | commitå‰ | ãƒ†ã‚¹ãƒˆå¤±æ•— â†’ commitæ‹’å¦ |
| å¾Œæ–¹äº’æ›æ€§ãªã— | pushå‰ | çµ±åˆãƒ†ã‚¹ãƒˆå¤±æ•— â†’ pushä¸­æ­¢ |
| env-loader.jsæœªæ›´æ–° | deployå‰ | ãƒã‚§ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¨ãƒ©ãƒ¼ |
| Spreadsheetæ›¸ãè¾¼ã¿ã‚¨ãƒ©ãƒ¼ | å®Ÿè¡Œæ™‚ | ãƒ­ã‚° + Slacké€šçŸ¥ |

### Git Hooksè¨­å®š

```bash
# pre-commit: commitå‰ãƒã‚§ãƒƒã‚¯
.git/hooks/pre-commit
  â†“
å¤‰æ›´å½±éŸ¿ãƒã‚§ãƒƒã‚¯
  â†“
é–¢é€£ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
  â†“
æˆåŠŸ â†’ commitè¨±å¯
å¤±æ•— â†’ commitæ‹’å¦ + ã‚¨ãƒ©ãƒ¼è¡¨ç¤º

# pre-push: pushå‰ãƒã‚§ãƒƒã‚¯
.git/hooks/pre-push
  â†“
çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
  â†“
æˆåŠŸ â†’ pushè¨±å¯
å¤±æ•— â†’ pushæ‹’å¦ + è©³ç´°ãƒ­ã‚°
```

---

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### âœ… DOï¼ˆæ¨å¥¨ï¼‰

1. **DataLayerã‚’çµŒç”±ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹**
   ```javascript
   // è‰¯ã„ä¾‹
   const data = DataLayer.read(merchantId, 'branchAddresses');
   DataLayer.write(merchantId, 'branchAddresses', value);
   ```

2. **ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°**
   ```javascript
   // ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›´æ™‚
   const DATA_FORMAT_VERSION = '2.0';
   ```

3. **å¾Œæ–¹äº’æ›æ€§ã®ä¿æŒ**
   ```javascript
   // è‡ªå‹•å±•é–‹æ©Ÿèƒ½
   if (isCompressed(data)) {
     data = decompress(data);
   }
   ```

4. **å¤‰æ›´æ™‚ã®ãƒ†ã‚¹ãƒˆ**
   ```bash
   npm run test:integration
   ```

### âŒ DON'Tï¼ˆéæ¨å¥¨ï¼‰

1. **ç›´æ¥Spreadsheetã‚¢ã‚¯ã‚»ã‚¹**
   ```javascript
   // æ‚ªã„ä¾‹
   const sheet = SpreadsheetApp.openById(SPREADSHEET_ID);
   const data = sheet.getRange('P2').getValue();
   ```

2. **ä»–Systemã®ç›´æ¥å‘¼ã³å‡ºã—**
   ```javascript
   // æ‚ªã„ä¾‹
   const result = MerchantSystem.getData(id);
   ```

3. **ãƒ†ã‚¹ãƒˆãªã—ã®ãƒ‡ãƒ—ãƒ­ã‚¤**
   ```bash
   # æ‚ªã„ä¾‹
   clasp push  # ãƒ†ã‚¹ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—
   ```

4. **Script Propertiesã®ç›´æ¥å¤‰æ›´**
   ```javascript
   // æ‚ªã„ä¾‹
   PropertiesService.getScriptProperties().setProperty('KEY', 'value');
   // è‰¯ã„ä¾‹: å°‚ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆçµŒç”±ã§å…¨ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆå¾Œã«å¤‰æ›´
   ```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ: ä»–ã‚·ã‚¹ãƒ†ãƒ ãŒå‹•ã‹ãªããªã£ãŸ

```bash
# 1. æœ€æ–°ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒ
cd /Users/ryuryu
tar -xzf gas-backup-complete-20251031_142529.tar.gz

# 2. çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:integration

# 3. ã‚¨ãƒ©ãƒ¼ç®‡æ‰€ç‰¹å®š
npm run test:merchant  # åŠ ç›Ÿåº—ã‚·ã‚¹ãƒ†ãƒ ã®ã¿ãƒ†ã‚¹ãƒˆ
```

### å•é¡Œ: ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œãªã„

```bash
# DataLayerã®å‹•ä½œç¢ºèª
node gas/scripts/test-data-layer.js

# Spreadsheetç›´æ¥ç¢ºèª
node gas/check-properties.js
```

### å•é¡Œ: ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã«èªè¨¼ã‚¨ãƒ©ãƒ¼

```bash
# env-loader.jsæ›´æ–°ç¢ºèª
grep -r "GAS_URL" franchise-register/dist/js/env-loader.js
grep -r "GAS_URL" admin-dashboard/dist/js/env-loader.js
grep -r "GAS_URL" franchise-dashboard/dist/merchant-portal/env-loader.js

# å…¨ã¦åŒã˜V1470ç­‰ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª
```

---

## é€£çµ¡å…ˆãƒ»ã‚µãƒãƒ¼ãƒˆ

**ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å ´æ‰€**: `/Users/ryuryu/gas-backup-complete-*.tar.gz`
**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: `/Users/ryuryu/franchise-register/gas/docs/`
**ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `/Users/ryuryu/franchise-register/gas/tests/`

---

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | å¤‰æ›´å†…å®¹ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|------|---------|----------|
| 2025-10-31 | åˆç‰ˆä½œæˆãƒ»è‡ªå‹•åŒ–åŸºç›¤æ§‹ç¯‰ | - |
| 2025-10-31 | DataLayerå®Ÿè£… | - |
| 2025-10-31 | çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè£… | - |
