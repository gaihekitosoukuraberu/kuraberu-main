<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>【完全無料】外壁塗装くらべる</title>
    <meta name="description" content="日本一簡単で安全な外壁塗装比較サイト。まずは10秒AI診断から" />
    <meta name="keywords" content="外壁塗装, 見積もり比較, 最低価格, 訪問業者, 塗料, アフターフォロー, カラーシミュレーション, 助成金, 補修, カバー工法, 屋根材, 遮熱, 断熱, タイミング, 防音" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" id="viewport" />
    <meta name="format-detection" content="telephone=no" />
    <!-- OGP -->
    <meta property="og:url" content="https://gaihekikuraberu.com/lp/" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="【完全無料】外壁塗装くらべる" />
    <meta property="og:description" content="日本一簡単で安全な外壁塗装比較サイト。まずは10秒AI診断から" />
    <meta property="og:site_name" content="【完全無料】外壁塗装くらべる" />
    <meta property="og:image" content="https://gaihekikuraberu.com/lp/img/cmn/ogp.jpg" />
    <meta name="twitter:card" content="summary_large_image" />
    <!-- //OGP -->
    <link rel="icon" href="img/cmn/favicon.ico" />
    <link rel="apple-touch-icon" href="img/cmn/apple-touch-icon.png" />
    <!-- プリロード（アバター画像） -->
    <link rel="preload" href="images/avatars/319260ba-0b3d-47d0-b18f-abf530c2793e.png" as="image" />
    <!-- CSS -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100..900&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <!-- <link rel="stylesheet" href="css/delay_anim.css" /> -->
    <link rel="stylesheet" href="css/default.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/style_sp.css" />
    <!-- Tailwind CSS (BOTシステム用) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 郵便番号フォーム 光るアニメーション -->
    <style>
      @keyframes glow {
        0%, 100% {
          box-shadow: 0 0 20px rgba(59, 130, 246, 0.3), 0 0 40px rgba(59, 130, 246, 0.1);
        }
        50% {
          box-shadow: 0 0 30px rgba(59, 130, 246, 0.5), 0 0 60px rgba(59, 130, 246, 0.2);
        }
      }

      /* 郵便番号フォーム: スマホでも同じサイズを保つ */
      #postalFormSectionLP {
        margin-top: 20px !important;
        display: flex !important;
        justify-content: center !important;
        width: 100% !important;
      }
      #postalFormSectionLP > div {
        background: white !important;
        border-radius: 12px !important;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25) !important;
        border: 2px solid #93C5FD !important;
        padding: 24px !important;
        max-width: 384px !important;
        width: 384px !important;
        margin: 0 auto !important;
        transition: transform 0.3s !important;
        animation: glow 3s ease-in-out infinite !important;
      }
      @media (max-width: 767px) {
        #postalFormSectionLP {
          display: flex !important;
          justify-content: center !important;
          align-items: center !important;
          overflow-x: visible !important;
        }
        #postalFormSectionLP > div {
          width: 384px !important;
          padding: 24px !important;
          max-width: none !important;
          min-width: 384px !important;
          margin: 0 !important;
          transform: scale(0.95) !important;
          transform-origin: center center !important;
        }
      }
      @media (max-width: 400px) {
        #postalFormSectionLP > div {
          transform: scale(0.9) !important;
        }
      }

      /* BOTコンテナのズーム制御 */
      #gaiheki-bot-container {
        zoom: 1 !important;
        -moz-transform: scale(1) !important;
        -webkit-transform: scale(1) !important;
        transform: scale(1) !important;
        transform-origin: top left !important;
        font-size: 16px !important;
      }

      #gaiheki-bot-container * {
        font-size: inherit;
        zoom: 1;
      }

      /* 相場セクションの価格表示は大きく表示 */
      #priceSection .text-4xl {
        font-size: 2.25rem !important;  /* 36px */
        line-height: 2.5rem !important;
      }

      #priceSection .text-2xl {
        font-size: 1.5rem !important;  /* 24px */
        line-height: 2rem !important;
      }

      #priceSection .text-xl {
        font-size: 1.25rem !important;  /* 20px */
        line-height: 1.75rem !important;
      }

      #priceSection .text-sm {
        font-size: 0.875rem !important;  /* 14px */
        line-height: 1.25rem !important;
      }

      #priceSection .text-xs {
        font-size: 0.75rem !important;  /* 12px */
        line-height: 1rem !important;
      }

      #botParentContainer {
        max-width: 100vw !important;
        width: 100% !important;
        margin: 0 !important;
      }

      /* estimate-keep-system BOT CSS */
      .ai-message {
        background: linear-gradient(135deg, #7B9BF0 0%, #9EBDFD 100%);
        color: white;
        border-radius: 24px 24px 24px 4px;
        padding: 16px 20px;
        margin: 0;
        margin-left: -4px;
        max-width: 80%;
        word-wrap: break-word;
        font-size: 16px;
        line-height: 1.6;
        font-weight: 400;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        position: relative;
      }

      .ai-message-container {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        margin: 20px 0;
        padding-left: 12px;
      }

      .ai-avatar {
        width: 56px;
        height: 56px;
        border-radius: 50%;
        object-fit: cover;
        flex-shrink: 0;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        will-change: auto;
        image-rendering: -webkit-optimize-contrast;
        image-rendering: crisp-edges;
      }

      .user-message {
        background: #F5F5F5;
        color: #2D3748;
        border-radius: 24px 24px 4px 24px;
        padding: 16px 20px;
        margin: 20px 0;
        max-width: 80%;
        margin-left: auto;
        font-size: 16px;
        line-height: 1.6;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      }

      .choice-btn {
        border: 2px solid #E2E8F0;
        background: white;
        color: #4A5568;
        padding: 16px 20px;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 500;
        transition: all 0.3s ease;
        cursor: pointer;
        margin: 4px 0;
        min-height: 56px;
        display: flex;
        align-items: center;
        justify-content: flex-start;
        text-align: left;
      }

      .choice-btn:hover {
        background: #F7FAFC;
        border-color: #7B9BF0;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(123, 155, 240, 0.15);
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* 重要：モザイク効果 */
      .mosaic {
        filter: blur(8px);
        transition: filter 0.5s ease;
      }

      /* 電話番号入力フォーム */
      .phone-mini-form {
        background: linear-gradient(135deg, #EBF8FF, #DBEAFE);
        border-radius: 16px;
        padding: 24px;
        margin: 20px 0;
        animation: fadeIn 0.5s ease-out;
      }

      .phone-mini-form .form-title {
        font-size: 14px;
        font-weight: 600;
        color: #2D3748;
        margin-bottom: 16px;
      }

      .phone-input-wrapper {
        background: white !important;
        border: 3px solid #7DD3FC !important;
        border-radius: 12px;
        padding: 4px;
        margin-bottom: 12px;
        max-width: 400px;
        margin-left: auto;
        margin-right: auto;
      }

      .phone-error {
        color: #7DD3FC;
        font-size: 12px;
        text-align: center;
        margin-bottom: 12px;
        display: none;
      }

      .phone-error.show {
        display: block;
      }

      .waiting-animation {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
        position: relative;
        height: 120px;
      }

      .waiting-character {
        width: 180px;
        height: auto;
        position: absolute;
        opacity: 0;
        animation: slideshow 3s infinite;
      }

      .waiting-character:nth-child(1) {
        animation-delay: 0s;
      }

      .waiting-character:nth-child(2) {
        animation-delay: 1s;
      }

      .waiting-character:nth-child(3) {
        animation-delay: 2s;
      }

      @keyframes slideshow {
        0% {
          opacity: 0;
          transform: scale(0.95);
        }
        10%, 30% {
          opacity: 1;
          transform: scale(1);
        }
        40% {
          opacity: 0;
          transform: scale(0.95);
        }
        100% {
          opacity: 0;
          transform: scale(0.95);
        }
      }

      .phone-input {
        width: 100%;
        padding: 12px;
        font-size: 18px;
        border: none;
        outline: none;
        text-align: center;
        font-weight: 500;
      }

      .phone-input::placeholder {
        color: #D1D5DB;
      }

      .phone-submit-btn {
        width: 100%;
        max-width: 400px;
        background: linear-gradient(135deg, #7B9BF0, #9EBDFD);
        color: white;
        padding: 14px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        outline: none;
        margin: 0 auto;
        display: block;
      }

      .phone-submit-btn:hover:not(:disabled) {
        background: linear-gradient(135deg, #6B8BE0, #8EADED);
        transform: translateY(-1px);
      }

      .phone-submit-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      /* ランキングセクションのテーマカラー */
      .ranking-section[data-theme="blue"] {
        background-color: #EBF8FF !important;
      }

      .ranking-section[data-theme="orange"] {
        background-color: #FFF5EB !important;
      }

      .ranking-section[data-theme="green"] {
        background-color: #F0FDF4 !important;
      }

      .ranking-section[data-theme="purple"] {
        background-color: #FAF5FF !important;
      }

      /* キープボタン */
      .keep-btn {
        background: #FEF3C7;
        color: #92400E;
        transition: all 0.3s;
      }

      .keep-btn:hover {
        background: #FDE68A;
      }

      .keep-btn.active {
        background: #F59E0B;
        color: white;
        font-weight: 600;
      }

      .keep-btn.active .keep-text::before {
        content: 'キープ中';
      }

      .keep-btn.active .keep-text > span {
        display: none;
      }

      /* 通知バッジ */
      .notification-badge {
        position: absolute;
        top: -12px;
        right: -12px;
        background: #EF4444;
        color: white;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        font-weight: bold;
      }

      /* ランキングテーマ */
      .ranking-section[data-theme="blue"] {
        background-color: #EBF8FF;
      }
    </style>

    <!-- ローディングアニメーション用CSS -->
    <style>
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <!-- header -->
      <header class="header">
        <h1 class="header__logo">
          <img src="img/cmn/logo.png" alt="AI業者比較サイト 外壁塗装くらべる" />
        </h1>
        <!-- globalnavi -->
        <div class="header__nav">
          <div class="header__nav__hamburger">
            <span></span>
            <span></span>
          </div>
          <div class="header__nav__global">
            <div class="header__nav__global__logo sponly">
              <img src="img/cmn/logo.png" alt="AI業者比較サイト 外壁塗装くらべる" />
            </div>
            <nav>
              <ul class="header__nav__global__lists">
                <li>
                  <a id="analy-header_link01" href="#caution">知らなきゃ損する注意点</a>
                </li>
                <li>
                  <a id="analy-header_link02" href="#step">業者の探し方</a>
                </li>
                <li>
                  <a id="analy-header_link03" href="#qa">よくある質問</a>
                </li>
                <li>
                  <a id="analy-header_link04" href="#form">お問い合わせ</a>
                </li>
                <li class="header__nav__global__lists__item">
                  <div class="header__nav__global__lists__item__icon mail">
                    <a id="analy-header_btn03" href="#form"><img src="img/cmn/mail_icon.svg" alt="メールのアイコン" /></a>
                  </div>
                  <div class="header__nav__global__lists__item__icon tel">
                    <a id="analy-header_btn04" href="tel:05017255045"><img src="img/cmn/tel_icon.svg" alt="電話のアイコン" /></a>
                  </div>
                </li>
              </ul>
            </nav>
          </div>
          <ul class="header__nav__icon__lists">
            <li>
              <a id="analy-header_btn01" href="#form"><img src="img/cmn/mail_icon.svg" alt="メールのアイコン" /></a>
            </li>
            <li>
              <a id="analy-header_btn02" href="tel:05017255045"><img src="img/cmn/tel_icon.svg" alt="電話のアイコン" /></a>
            </li>
          </ul>
        </div>
        <!-- //globalnavi -->
      </header>
      <!-- //header -->

      <!-- mv -->
      <div class="mv">
        <div class="container-max">
          <div class="mv__before">
            <h2 class="mv__before__tit">
              <picture>
                <source srcset="img/mv/tit_sp.png" media="(max-width: 767px)" />
                <img src="img/mv/tit.png" alt="たった10秒で優良業者も相場も今すぐわかる" />
              </picture>
            </h2>
            <div class="mv__before__img">
              <picture>
                <source srcset="img/mv/img_sp.png" media="(max-width: 767px)" />
                <img src="img/mv/img.png" alt="気になるキーワードで検索" />
              </picture>
            </div>
            <div class="mv__before__txt">
              <picture>
                <source srcset="img/mv/txt_sp.png" media="(max-width: 767px)" />
                <img src="img/mv/txt.png" alt="完全無料 いつでもサポート無料 累計お客様対応数6.3万人" />
              </picture>
            </div>
          </div>
          <div class="mv__after">
            <div class="mv__after__img">
              <img src="img/mv/Flipyx1.gif" alt="" />
            </div>
          </div>
          <!-- 郵便番号入力フォーム -->
          <div id="postalFormSectionLP" style="margin-top: 20px;">
              <div style="background: white; border-radius: 12px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); border: 2px solid #93C5FD; padding: 24px; max-width: 384px; margin: 0 auto; transition: transform 0.3s; animation: glow 3s ease-in-out infinite;">
                  <div style="margin-bottom: 12px;">
                      <span style="background: #22D3EE; color: white; border-radius: 9999px; padding: 4px 12px; font-size: 12px; font-weight: 500; display: inline-block;">かんたん10秒！</span>
                  </div>
                  <div style="font-size: 18px; font-weight: bold; margin-bottom: 12px; text-align: center; color: #1F2937;">
                      郵便番号で今すぐ相場チェック！
                  </div>
                  <div style="display: flex; flex-direction: column; gap: 12px;">
                      <input type="text" id="postalCode" placeholder="〒100-0001" maxlength="8"
                             style="width: 100%; border: 2px solid #FCD34D; border-radius: 8px; padding: 12px 16px; text-align: center; font-size: 16px; outline: none; background: #EFF6FF;">
                      <button id="searchButton" type="button"
                              style="width: 100%; background: linear-gradient(135deg, #3B82F6, #2563EB); color: white; padding: 12px; border-radius: 8px; font-weight: bold; font-size: 16px; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: all 0.3s;">
                          🔍 無料で相場を見る
                      </button>
                      <div style="display: flex; align-items: center; justify-content: center; font-size: 14px; color: #4B5563; gap: 4px;">
                          🔒 個人情報保護・SSL暗号化通信で安全
                      </div>
                  </div>
              </div>
          </div>
        </div>
      </div>
      <!-- //mv -->

      <!-- modal -->
      <div id="modal" class="modal">
        <div class="modal__wrapper">
          <span class="modal__close">
            <img src="img/mv/close.png" alt="閉じるボタン" />
          </span>
          <div class="modal__content">
            <p class="modal__content__tit">気になるキーワードを選択してください</p>
            <ul class="modal__content__lists">
              <li><button id="analy-modal_btn01" onclick="startScenario('クチコミ')">クチコミ</button></li>
              <li><button id="analy-modal_btn02" onclick="startScenario('おすすめ')">おすすめ</button></li>
              <li><button id="analy-modal_btn03" onclick="startScenario('最低価格')">最低価格</button></li>
              <li><button id="analy-modal_btn04" onclick="startScenario('訪問業者')">訪問業者</button></li>
              <li><button id="analy-modal_btn05" onclick="startScenario('塗料')">塗料</button></li>
              <li><button id="analy-modal_btn06" onclick="startScenario('アフターフォロー')">アフターフォロー</button></li>
              <li><button id="analy-modal_btn07" onclick="startScenario('雨漏り')">雨漏り</button></li>
              <li><button id="analy-modal_btn08" onclick="startScenario('カラーイメージ')">カラーイメージ</button></li>
              <li><button id="analy-modal_btn09" onclick="startScenario('助成金')">助成金</button></li>
              <li><button id="analy-modal_btn10" onclick="startScenario('補修')">補修</button></li>
              <li><button id="analy-modal_btn11" onclick="startScenario('カバー工法')">カバー工法</button></li>
              <li><button id="analy-modal_btn12" onclick="startScenario('屋根材')">屋根材</button></li>
              <li><button id="analy-modal_btn13" onclick="startScenario('遮熱・断熱')">遮熱・断熱</button></li>
              <li><button id="analy-modal_btn14" onclick="startScenario('タイミング')">タイミング</button></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- //modal -->

      <!-- f-search -->
      <section class="f-search">
        <div class="container-max">
          <div class="f-search__item item01">
            <div class="f-search__item__bg">
              <h3 class="f-search-mod-tit">地元で人気の業者を探す</h3>
              <ul class="f-search__item__btn__lists">
                <li>
                  <button id="analy-f-search_btn01" onclick="startScenario('クチコミ・評価順で探す')">
                    <picture>
                      <source srcset="img/fsearch/btn01_sp.png" media="(max-width: 767px)" />
                      <img src="img/fsearch/btn01.png" alt="クチコミ・評価順で探す" />
                    </picture>
                  </button>
                </li>
                <li>
                  <button id="analy-f-search_btn02" onclick="startScenario('実績順で探す')">
                    <picture>
                      <source srcset="img/fsearch/btn02_sp.png" media="(max-width: 767px)" />
                      <img src="img/fsearch/btn02.png" alt="実績順で探す" />
                    </picture>
                  </button>
                </li>
                <li>
                  <button id="analy-f-search_btn03" onclick="startScenario('費用が安い順で探す')">
                    <picture>
                      <source srcset="img/fsearch/btn03_sp.png" media="(max-width: 767px)" />
                      <img src="img/fsearch/btn03.png" alt="費用が安い順で探す" />
                    </picture>
                  </button>
                </li>
              </ul>
            </div>
          </div>
          <div class="f-search__item item02">
            <div class="f-search__item__bg">
              <h3 class="f-search-mod-tit">人気キーワードから探す</h3>
              <ul class="f-search__item__link__lists">
                <li><button id="analy-f-search_btn04" onclick="startScenario('クチコミ')">クチコミ</button></li>
                <li><button id="analy-f-search_btn05" onclick="startScenario('おすすめ')">おすすめ</button></li>
                <li><button id="analy-f-search_btn06" onclick="startScenario('助成金')">助成金</button></li>
                <li><button id="analy-f-search_btn07" onclick="startScenario('訪問業者')">訪問業者</button></li>
                <li><button id="analy-f-search_btn08" onclick="startScenario('屋根張替え')">屋根張替え</button></li>
                <li><button id="analy-f-search_btn09" onclick="startScenario('カバー工法')">カバー工法</button></li>
                <li><button id="analy-f-search_btn10" onclick="startScenario('ハウスメーカー')">ハウスメーカー</button></li>
                <li><button id="analy-f-search_btn11" onclick="startScenario('塗料')">塗料</button></li>
                <li><button id="analy-f-search_btn12" onclick="startScenario('施工時期')">施工時期</button></li>
                <li><button id="analy-f-search_btn13" onclick="startScenario('リフォームローン')">リフォームローン</button></li>
                <li><button id="analy-f-search_btn14" onclick="startScenario('高品質・長持ち')">高品質・長持ち</button></li>
                <li><button id="analy-f-search_btn15" onclick="startScenario('屋上・ベランダ防水')">屋上・ベランダ防水</button></li>
                <li><button id="analy-f-search_btn16" onclick="startScenario('ガルバリウム')">ガルバリウム</button></li>
                <li><button id="analy-f-search_btn17" onclick="startScenario('火災保険')">火災保険</button></li>
                <li><button id="analy-f-search_btn18" onclick="startScenario('カラーイメージ')">カラーイメージ</button></li>
                <li><button id="analy-f-search_btn19" onclick="startScenario('雨漏り')">雨漏り</button></li>
              </ul>
            </div>
          </div>
        </div>
      </section>
      <!-- //f-search -->

      <!-- anchor -->
      <section class="anchor">
        <div class="container">
          <h3 class="anchor__tit">外壁塗装くらべるについて<br class="sponly" />もっと知る</h3>
          <ul class="anchor__lists">
            <li>
              <a id="analy-anchor_btn01" href="#caution">
                <picture>
                  <source srcset="img/anchor/btn01_sp.png" media="(max-width: 767px)" />
                  <img src="img/anchor/btn01.png" alt="知らなきゃ損する注意点" />
                </picture>
              </a>
            </li>
            <li>
              <a id="analy-anchor_btn02" href="#step">
                <picture>
                  <source srcset="img/anchor/btn02_sp.png" media="(max-width: 767px)" />
                  <img src="img/anchor/btn02.png" alt="業者の探し方" />
                </picture>
              </a>
            </li>
            <li>
              <a id="analy-anchor_btn03" href="#qa">
                <picture>
                  <source srcset="img/anchor/btn03_sp.png" media="(max-width: 767px)" />
                  <img src="img/anchor/btn03.png" alt="よくある質問" />
                </picture>
              </a>
            </li>
          </ul>
        </div>
      </section>
      <!-- //anchor -->

      <!-- search -->
      <section class="search">
        <div class="container-max">
          <div class="search__before">
            <div class="search__before__cost">
              <div class="search__before__cost__bg">
                <h3 class="search-mod-tit">工事予算から探す</h3>
                <ul class="search__before__cost__lists">
                  <li>
                    <button id="analy-search_btn01" onclick="startScenario('~50万円')">
                      <img src="img/search/before_btn01.png" alt="~50万円" />
                    </button>
                  </li>
                  <li>
                    <button id="analy-search_btn02" onclick="startScenario('50~100万円')">
                      <img src="img/search/before_btn02.png" alt="50~100万円" />
                    </button>
                  </li>
                  <li>
                    <button id="analy-search_btn03" onclick="startScenario('100~200万円')">
                      <img src="img/search/before_btn03.png" alt="100~200万円" />
                    </button>
                  </li>
                  <li>
                    <button id="analy-search_btn04" onclick="startScenario('200万円~')">
                      <img src="img/search/before_btn04.png" alt="200万円~" />
                    </button>
                  </li>
                </ul>
              </div>
            </div>
            <div class="search__before__aging">
              <div class="search__before__aging__bg">
                <h3 class="search-mod-tit">劣化状況から探す</h3>
                <ul class="search__before__aging__lists">
                  <li>
                    <button id="analy-search_btn05" onclick="startScenario('チョークのような粉がつく')">
                      <picture>
                        <source srcset="img/search/before_btn05_sp.jpg" media="(max-width: 767px)" />
                        <img src="img/search/before_btn05.jpg" alt="チョークのような粉がつく" />
                      </picture>
                    </button>
                  </li>
                  <li>
                    <button id="analy-search_btn06" onclick="startScenario('ひび割れている')">
                      <picture>
                        <source srcset="img/search/before_btn06_sp.jpg" media="(max-width: 767px)" />
                        <img src="img/search/before_btn06.jpg" alt="ひび割れている" />
                      </picture>
                    </button>
                  </li>
                  <li>
                    <button id="analy-search_btn07" onclick="startScenario('はがれている')">
                      <picture>
                        <source srcset="img/search/before_btn07_sp.jpg" media="(max-width: 767px)" />
                        <img src="img/search/before_btn07.jpg" alt="はがれている" />
                      </picture>
                    </button>
                  </li>
                  <li>
                    <button id="analy-search_btn08" onclick="startScenario('汚れ・くすみがある')">
                      <picture>
                        <source srcset="img/search/before_btn08_sp.jpg" media="(max-width: 767px)" />
                        <img src="img/search/before_btn08.jpg" alt="汚れ・くすみがある" />
                      </picture>
                    </button>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="search__after">
          <div class="search__after__content01">
            <div class="container">
              <div class="search__after__content01__feature">
                <h3 class="search-mod-tit">業者の特色から探す</h3>
                <ul class="search__after__content01__feature__lists">
                  <li>
                    <button id="analy-search_btn09" onclick="startScenario('設立年数')">
                      <picture>
                        <source srcset="img/search/after_btn01_sp.png" media="(max-width: 767px)" />
                        <img src="img/search/after_btn01.png" alt="設立年数" />
                      </picture>
                    </button>
                  </li>
                  <li>
                    <button id="analy-search_btn10" onclick="startScenario('従業員数')">
                      <picture>
                        <source srcset="img/search/after_btn02_sp.png" media="(max-width: 767px)" />
                        <img src="img/search/after_btn02.png" alt="従業員数" />
                      </picture>
                    </button>
                  </li>
                  <li>
                    <button id="analy-search_btn11" onclick="startScenario('保有資格')">
                      <picture>
                        <source srcset="img/search/after_btn03_sp.png" media="(max-width: 767px)" />
                        <img src="img/search/after_btn03.png" alt="保有資格" />
                      </picture>
                    </button>
                  </li>
                  <li>
                    <button id="analy-search_btn12" onclick="startScenario('職人直営')">
                      <picture>
                        <source srcset="img/search/after_btn04_sp.png" media="(max-width: 767px)" />
                        <img src="img/search/after_btn04.png" alt="職人直営" />
                      </picture>
                    </button>
                  </li>
                </ul>
              </div>
              <div class="search__after__content01__support">
                <h3 class="search-mod-tit">サポート内容で探す</h3>
                <ul class="search__after__content01__support__lists">
                  <li>
                    <button id="analy-search_btn13" onclick="startScenario('ローンOK')">
                      <picture>
                        <source srcset="img/search/after_btn05_sp.png" media="(max-width: 767px)" />
                        <img src="img/search/after_btn05.png" alt="ローンOK" />
                      </picture>
                    </button>
                  </li>
                  <li>
                    <button id="analy-search_btn14" onclick="startScenario('各種保険完備')">
                      <picture>
                        <source srcset="img/search/after_btn06_sp.png" media="(max-width: 767px)" />
                        <img src="img/search/after_btn06.png" alt="各種保険完備" />
                      </picture>
                    </button>
                  </li>
                  <li>
                    <button id="analy-search_btn15" onclick="startScenario('アフターフォローあり')">
                      <picture>
                        <source srcset="img/search/after_btn07_sp.png" media="(max-width: 767px)" />
                        <img src="img/search/after_btn07.png" alt="アフターフォローあり" />
                      </picture>
                    </button>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="search__after__content02">
            <div class="container-max">
              <h3 class="search__after__content02__tit">工事が必要な箇所で探す</h3>
              <div class="search__after__content02__wrap">
                <div class="search__after__content02__wrap__item">
                  <div class="swiper">
                    <div class="swiper-wrapper">
                      <div class="swiper-slide">
                        <img class="objectfit cover" src="img/search/slide01.jpg" alt="" />
                      </div>
                      <div class="swiper-slide">
                        <img class="objectfit cover" src="img/search/slide02.jpg" alt="" />
                      </div>
                      <div class="swiper-slide">
                        <img class="objectfit cover" src="img/search/slide03.jpg" alt="" />
                      </div>
                    </div>
                  </div>
                  <div class="search__after__content02__wrap__item__summary">
                    <p class="search__after__content02__wrap__item__summary__cat">外壁 + 屋根</p>
                    <div class="search__after__content02__wrap__item__summary__btn">
                      <button id="analy-search_btn16" onclick="startScenario('塗装したい')">
                        <img src="img/search/after_btn09.png" alt="塗装したい" />
                      </button>
                    </div>
                    <div class="search__after__content02__wrap__item__summary__btn">
                      <button id="analy-search_btn17" onclick="startScenario('張り替えたい')">
                        <img src="img/search/after_btn10.png" alt="張り替えたい" />
                      </button>
                    </div>
                    <div class="search__after__content02__wrap__item__summary__btn">
                      <button id="analy-search_btn18" onclick="startScenario('補修したい')">
                        <img src="img/search/after_btn11.png" alt="補修したい" />
                      </button>
                    </div>
                  </div>
                </div>
                <div class="search__after__content02__wrap__item">
                  <div class="swiper">
                    <div class="swiper-wrapper">
                      <div class="swiper-slide">
                        <img class="objectfit cover" src="img/search/slide04.jpg" alt="" />
                      </div>
                      <div class="swiper-slide">
                        <img class="objectfit cover" src="img/search/slide05.jpg" alt="" />
                      </div>
                      <div class="swiper-slide">
                        <img class="objectfit cover" src="img/search/slide06.jpg" alt="" />
                      </div>
                    </div>
                  </div>
                  <div class="search__after__content02__wrap__item__summary">
                    <p class="search__after__content02__wrap__item__summary__cat">外壁のみ</p>
                    <div class="search__after__content02__wrap__item__summary__btn">
                      <button id="analy-search_btn19" onclick="startScenario('塗装したい')">
                        <img src="img/search/after_btn09.png" alt="塗装したい" />
                      </button>
                    </div>
                    <div class="search__after__content02__wrap__item__summary__btn">
                      <button id="analy-search_btn20" onclick="startScenario('張り替えたい')">
                        <img src="img/search/after_btn10.png" alt="張り替えたい" />
                      </button>
                    </div>
                    <div class="search__after__content02__wrap__item__summary__btn">
                      <button id="analy-search_btn21" onclick="startScenario('補修したい')">
                        <img src="img/search/after_btn11.png" alt="補修したい" />
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- //search -->

      <!-- caution -->
      <section class="caution" id="caution">
        <div class="container">
          <h3 class="mod-tit">
            <span class="mod-tit__small">意外とあるある?!</span>
            <span class="mod-tit__large"
              ><span class="mod-tit--blue">一般的な見積サイトの<br class="sponly" />落とし穴３選</span></span
            >
          </h3>
          <ol class="caution__lists">
            <li class="caution__lists__item">
              <div class="caution__lists__item__before">
                <div class="caution__lists__item__before__num">
                  <img src="img/caution/num01.png" alt="01" />
                </div>
                <h4 class="caution__lists__item__before__tit">"<span class="caution__lists__item__before__tit--marker">相場を全然教えてくれない</span>"</h4>
                <p class="caution__lists__item__before__txt">相場がわからないと高く見積もられていることに気づけない場合も...</p>
              </div>
              <div class="caution__lists__item__after">
                <div class="caution__lists__item__after__content">
                  <div class="caution__lists__item__after__content__fwrap">
                    <p class="caution__lists__item__after__content__fwrap__cat">ご安心ください！</p>
                    <p class="caution__lists__item__after__content__fwrap__tit">相場は10秒で出てきます</p>
                  </div>
                  <div class="caution__lists__item__after__content__wrap">
                    <div class="caution__lists__item__after__content__wrap__icon">
                      <img src="img/caution/icon.png" alt="" />
                    </div>
                    <p class="caution__lists__item__after__content__wrap__txt">相場を知ったことで、<span class="caution__lists__item__after__content__wrap__txt--strong">価格を30%下げられた事例</span>もございます。<br />まずは相場だけでも確認してみてください。</p>
                  </div>
                  <button id="analy-caution_btn01" class="caution__lists__item__after__content__btn" onclick="startScenario('今すぐ相場を確認する')">
                    <img src="img/caution/btn01.png" alt="今すぐ相場を確認する" />
                  </button>
                </div>
                <div class="caution__lists__item__after__img">
                  <img src="img/caution/img01.jpg" alt="" />
                </div>
              </div>
            </li>
            <li class="caution__lists__item">
              <div class="caution__lists__item__before">
                <div class="caution__lists__item__before__num">
                  <img src="img/caution/num02.png" alt="02" />
                </div>
                <h4 class="caution__lists__item__before__tit">"<span class="caution__lists__item__before__tit--marker">信用できない業者がいる</span>"</h4>
                <p class="caution__lists__item__before__txt">担当者が勘で選んだ業者しか紹介されないので、ミスマッチが起きてしまうかも...</p>
              </div>
              <div class="caution__lists__item__after">
                <div class="caution__lists__item__after__content">
                  <div class="caution__lists__item__after__content__fwrap">
                    <p class="caution__lists__item__after__content__fwrap__cat">実績ある業者だけ集めた</p>
                    <p class="caution__lists__item__after__content__fwrap__tit">ランキングから選べます</p>
                  </div>
                  <div class="caution__lists__item__after__content__wrap">
                    <div class="caution__lists__item__after__content__wrap__icon">
                      <img src="img/caution/icon.png" alt="" />
                    </div>
                    <p class="caution__lists__item__after__content__wrap__txt">コスパ順、クチコミ順、品質順のランキングから、お好きな業者の情報で比較できます！</p>
                  </div>
                  <button id="analy-caution_btn02" class="caution__lists__item__after__content__btn" onclick="startScenario('実際のランキングを見る')">
                    <img src="img/caution/btn02.png" alt="実際のランキングを見る" />
                  </button>
                </div>
                <div class="caution__lists__item__after__img">
                  <img src="img/caution/img02.jpg" alt="" />
                </div>
              </div>
            </li>
            <li class="caution__lists__item">
              <div class="caution__lists__item__before">
                <div class="caution__lists__item__before__num">
                  <img src="img/caution/num03.png" alt="03" />
                </div>
                <h4 class="caution__lists__item__before__tit">"<span class="caution__lists__item__before__tit--marker">営業電話がしつこい</span>"</h4>
                <p class="caution__lists__item__before__txt">一度電話番号を入力しただけなのに、業者や担当者から毎日電話がかかってくるのもストレス･･･</p>
              </div>
              <div class="caution__lists__item__after">
                <div class="caution__lists__item__after__content">
                  <div class="caution__lists__item__after__content__fwrap">
                    <p class="caution__lists__item__after__content__fwrap__cat">不要な営業電話は</p>
                    <p class="caution__lists__item__after__content__fwrap__tit">ルールで禁止しています</p>
                  </div>
                  <div class="caution__lists__item__after__content__wrap">
                    <div class="caution__lists__item__after__content__wrap__icon">
                      <img src="img/caution/icon.png" alt="" />
                    </div>
                    <p class="caution__lists__item__after__content__wrap__txt">
                      個人情報は厳重に扱っていますので、しつこい電話ストレスの心配はありません。<br />
                      ですが何かお困りごとがありましたら、<span class="caution__lists__item__after__content__wrap__txt--strong">無料でサポートいたします。</span>
                    </p>
                  </div>
                  <a id="analy-caution_btn03" class="caution__lists__item__after__content__btn" href="tel:05017255045">
                    <img src="img/caution/btn03.png" alt="お気軽にお電話ください" />
                  </a>
                </div>
                <div class="caution__lists__item__after__img">
                  <picture>
                    <source srcset="img/caution/img03_sp.jpg" media="(max-width: 767px)" />
                    <img src="img/caution/img03.jpg" alt="" />
                  </picture>
                </div>
              </div>
            </li>
          </ol>
        </div>
      </section>
      <!-- //caution -->

      <!-- step -->
      <section class="step" id="step">
        <div class="container-max">
          <h3 class="mod-tit">
            <span class="mod-tit__small">業者探しは</span>
            <span class="mod-tit__large"><span class="mod-tit--blue">かんたん3ステップ！</span></span>
          </h3>
          <div class="step__video"></div>
          <ol class="step__lists">
            <li class="step__lists__item">
              <div class="step__lists__item__wrap">
                <div class="step__lists__item__wrap__num">
                  <img src="img/step/num01.png" alt="01" />
                </div>
                <h4 class="step__lists__item__wrap__tit">
                  <span class="step__lists__item__wrap__tit--large">相場をチェック</span>
                </h4>
              </div>
              <div class="step__lists__item__content">
                <div class="step__lists__item__content__img">
                  <img src="img/step/img01.png" alt="" />
                </div>
                <p class="step__lists__item__content__txt">まずはお住まいの地域の相場を確認しましょう。</p>
                <button id="analy-step_btn01" class="step__lists__item__content__btn" onclick="startScenario('今すぐ相場を確認する')">
                  <img src="img/step/btn.png" alt="今すぐ相場を確認する" />
                </button>
              </div>
            </li>
            <li class="step__lists__item">
              <div class="step__lists__item__wrap">
                <div class="step__lists__item__wrap__num">
                  <img src="img/step/num02.png" alt="02" />
                </div>
                <h4 class="step__lists__item__wrap__tit">
                  <span class="step__lists__item__wrap__tit--small">AIチャットで</span>
                  <span class="step__lists__item__wrap__tit--large">最適な業者を表示</span>
                </h4>
              </div>
              <div class="step__lists__item__content">
                <div class="step__lists__item__content__img">
                  <img src="img/step/img02.png" alt="" />
                </div>
                <p class="step__lists__item__content__txt">簡単なヒアリングを行い、それをもとにコスパ順、クチコミ順、品質順のランキングを表示します。</p>
              </div>
            </li>
            <li class="step__lists__item">
              <div class="step__lists__item__wrap">
                <div class="step__lists__item__wrap__num">
                  <img src="img/step/num03.png" alt="01" />
                </div>
                <h4 class="step__lists__item__wrap__tit">
                  <span class="step__lists__item__wrap__tit--small">あとは気になる業者を</span>
                  <span class="step__lists__item__wrap__tit--large">選ぶだけ</span>
                </h4>
              </div>
              <div class="step__lists__item__content">
                <div class="step__lists__item__content__img">
                  <img src="img/step/img03.png" alt="" />
                </div>
                <p class="step__lists__item__content__txt">ランキングから気になる業者を選んだら、詳しい情報を取得できます。</p>
              </div>
            </li>
          </ol>
        </div>
      </section>
      <!-- //step -->

      <!-- qa -->
      <section class="qa" id="qa">
        <div class="container">
          <h3 class="mod-tit">
            <span class="mod-tit__large">よくある質問</span>
          </h3>
          <div class="qa__lists">
            <div class="qa__lists__item">
              <div class="qa__lists__item__parent">
                <span class="qa__lists__item__parent--icon"><img src="img/qa/q_icon.png" alt="Q" /></span>
                <span class="qa__lists__item__parent--txt">見積りは無料ですか？</span>
              </div>
              <div class="qa__lists__item__child">
                <div class="qa__lists__item__child__inner">はい。<br /><span class="qa__lists__item__child__inner--strong">相場チェックから業者比較、見積もり、その後のサポートまで、すべて無料です。</span><br />当サービスは広告費で運営しているため、お客様にご負担いただく費用はありません。<br />また、万が一契約された後も、法外な追加料金が発生しないようサポートしますのでご安心ください。</div>
              </div>
            </div>
            <div class="qa__lists__item">
              <div class="qa__lists__item__parent">
                <span class="qa__lists__item__parent--icon"><img src="img/qa/q_icon.png" alt="Q" /></span>
                <span class="qa__lists__item__parent--txt">相場を知りたいのですが、郵便番号を入力するだけでいいんですか？</span>
              </div>
              <div class="qa__lists__item__child">
                <div class="qa__lists__item__child__inner">はい。<br /><span class="qa__lists__item__child__inner--strong">郵便番号を入力していただくと、地域ごとの相場価格がすぐに分かります。</span><br />その後も簡単な質問に答えるだけで、優良な業者ランキングをご覧いただけます。<br />見積もりやサポートもすべて無料でご利用可能です。</div>
              </div>
            </div>
            <div class="qa__lists__item">
              <div class="qa__lists__item__parent">
                <span class="qa__lists__item__parent--icon"><img src="img/qa/q_icon.png" alt="Q" /></span>
                <span class="qa__lists__item__parent--txt">見積りを取ったら、必ず契約しないといけませんか？</span>
              </div>
              <div class="qa__lists__item__child">
                <div class="qa__lists__item__child__inner">いいえ。契約の義務は一切ありません。<br /><span class="qa__lists__item__child__inner--strong">当サービスは「相場を知る」「業者を比較する」ことに特化しているため、無理な営業や契約を迫ることはありません。</span><br />リフォームは高額な買い物です。焦らず、複数の見積もりをじっくり比較することが、失敗しないための最善策です。<br />また、しつこい営業は加盟店ルールで厳しく禁止しています。<br />万が一トラブルがあった際は、当社のサポートセンターにご連絡ください。</div>
              </div>
            </div>
            <div class="qa__lists__item">
              <div class="qa__lists__item__parent">
                <span class="qa__lists__item__parent--icon"><img src="img/qa/q_icon.png" alt="Q" /></span>
                <span class="qa__lists__item__parent--txt">どんな業者が紹介されますか？</span>
              </div>
              <div class="qa__lists__item__child">
                <div class="qa__lists__item__child__inner">厳しい審査をクリアした優良業者のみが加盟しています。<br /><span class="qa__lists__item__child__inner--strong">さらに、AIがお客様のお家や施工条件に最適な業者を自動で選定し、ランキング形式でご紹介します。</span><br />お客様は、その中からご自身に合った業者を選ぶだけで、最適な見積もりを無料で手に入れることができます。</div>
              </div>
            </div>
            <div class="qa__lists__item">
              <div class="qa__lists__item__parent">
                <span class="qa__lists__item__parent--icon"><img src="img/qa/q_icon.png" alt="Q" /></span>
                <span class="qa__lists__item__parent--txt">しつこい営業電話がかかってきませんか？</span>
              </div>
              <div class="qa__lists__item__child">
                <div class="qa__lists__item__child__inner"><span class="qa__lists__item__child__inner--strong">当サービスでは、不要な営業電話は一切ありません。</span>必要な連絡だけが届く仕組みになっています。</div>
              </div>
            </div>
            <div class="qa__lists__item">
              <div class="qa__lists__item__parent">
                <span class="qa__lists__item__parent--icon"><img src="img/qa/q_icon.png" alt="Q" /></span>
                <span class="qa__lists__item__parent--txt">相場価格と実際の見積りが違うことはありますか？</span>
              </div>
              <div class="qa__lists__item__child">
                <div class="qa__lists__item__child__inner">外壁塗装は工事内容や塗料の種類によって価格差が出やすいため、相場はあくまで目安ですが、実際の見積もり金額もほぼ同水準になるケースが多いです。<br /><span class="qa__lists__item__child__inner--strong">ただし、外壁塗装くらべるなら今お持ちの見積もりと同じ条件で、どこよりも安い最低価格保証が可能です。</span><br />まずはお気軽にご相談ください。</div>
              </div>
            </div>
            <div class="qa__lists__item">
              <div class="qa__lists__item__parent">
                <span class="qa__lists__item__parent--icon"><img src="img/qa/q_icon.png" alt="Q" /></span>
                <span class="qa__lists__item__parent--txt">助成金は利用できますか？</span>
              </div>
              <div class="qa__lists__item__child">
                <div class="qa__lists__item__child__inner"><span class="qa__lists__item__child__inner--strong">助成金は地域によって条件が異なりますが、当社の専門スタッフが申請のサポートまで丁寧にご案内します。</span><br />まずはお気軽にご相談ください。</div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- //qa -->

      <!-- form -->
      <section class="form" id="form">
        <div class="container-min">
          <h3 class="mod-tit">
            <span class="mod-tit__small">ご相談・サポートは無料です</span>
            <span class="mod-tit__large"><span class="mod-tit--blue">お問い合わせはこちら</span></span>
          </h3>
          <form class="km_form" method="post" action="mail.php">
            <dl class="form__lists">
              <!-- お名前 -->
              <dt class="form__lists__dt">お名前<span class="form__lists__dt__req">必須</span></dt>
              <dd class="form__lists__dd">
                <input class="km_valid_required" type="text" name="お名前" placeholder="山田 太郎" />
              </dd>
              <!-- メールアドレス -->
              <dt class="form__lists__dt">メールアドレス<span class="form__lists__dt__req">必須</span></dt>
              <dd class="form__lists__dd">
                <input class="km_valid_required" type="email" name="メールアドレス" placeholder="aaa@gmail.co.jp" />
              </dd>
              <!-- 電話番号 -->
              <dt class="form__lists__dt">電話番号<span class="form__lists__dt__req">必須</span></dt>
              <dd class="form__lists__dd">
                <input class="km_valid_required" type="tel" name="電話番号" placeholder="000-0000-0000" />
              </dd>
              <!-- 郵便番号 -->
              <dt class="form__lists__dt">郵便番号<span class="form__lists__dt__any">任意</span></dt>
              <dd class="form__lists__dd">
                <input type="text" name="郵便番号" placeholder="100-0001" />
              </dd>
              <!-- お問い合わせ内容（複数回答可） -->
              <dt class="form__lists__dt">お問い合わせ内容（複数回答可）<span class="form__lists__dt__req">必須</span></dt>
              <dd class="form__lists__dd">
                <div class="radio-style-checkbox km_valid_required_check">
                  <input type="checkbox" id="option1" name="お問い合わせ内容[]" value="助成金が利用できるか知りたい" />
                  <label for="option1">助成金が利用できるか知りたい</label>
                  <input type="checkbox" id="option2" name="お問い合わせ内容[]" value="自分に合った業者をすぐに知りたい" />
                  <label for="option2">自分に合った業者をすぐに知りたい</label>
                  <input type="checkbox" id="option3" name="お問い合わせ内容[]" value="とりあえず色々相談したい" />
                  <label for="option3">とりあえず色々相談したい</label>
                  <input type="checkbox" id="option4" name="お問い合わせ内容[]" value="その他" />
                  <label for="option4">その他</label>
                </div>
              </dd>
            </dl>
            <div class="form__privacy">
              <label for="privacy" class="km_valid_required_check">
                <input class="check_input" type="checkbox" name="当社規定のプライバシーポリシーへの同意します。" id="privacy" value="はい" />
                <span class="check_txt">当社規定のプライバシーポリシーへの同意します。</span>
              </label>
            </div>
            <div class="form__btn" style="position: relative;">
              <button id="analy-form_btn01" type="submit">
                <picture>
                  <source srcset="img/form/btn_sp.png" media="(max-width: 767px)" />
                  <img src="img/form/btn.png" alt="無料 今すぐ相場を確認する" />
                </picture>
              </button>
              <!-- ローディングオーバーレイ -->
              <div id="form-loading-overlay" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.9); border-radius: 50px; align-items: center; justify-content: center; z-index: 10;">
                <div style="text-align: center;">
                  <div style="border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 10px;"></div>
                  <p style="color: #3498db; font-weight: bold; font-size: 16px;">送信中...</p>
                </div>
              </div>
            </div>
            <p class="form__notes">お客様の情報は暗号化され、外部に漏れないよう保護されています</p>
          </form>
        </div>
      </section>
      <!-- //form -->

      <!-- footer -->
      <footer class="footer">
        <ul class="footer__lists">
          <li class="footer__lists__item"><a id="analy-footer_link01" href="https://gaihekikuraberu.com/company.html">会社概要</a></li>
          <li class="footer__lists__item"><a id="analy-footer_link02" href="https://gaihekikuraberu.com/privacy.html">プライバシーポリシー</a></li>
          <li class="footer__lists__item"><a id="analy-footer_link03" href="https://gaihekikuraberu.com/terms.html">利用規約</a></li>
        </ul>
        <small>&copy;外壁塗装くらべる All Rights Reserved.</small>
      </footer>
      <!-- //footer -->

      <!-- fixed-area -->
      <div class="fixed-area">
        <div class="fixed-area__wrap">
          <div class="fixed-area__wrap__img">
            <picture>
              <source srcset="img/cmn/fixed_img_sp.png" media="(max-width: 767px)" />
              <img src="img/cmn/fixed_img.png" alt="たった10秒で相場がわかる！" />
            </picture>
          </div>
          <div class="fixed-area__wrap__btn">
            <button id="analy-fixed-area_btn01" onclick="startScenario('今すぐ相場を確認する')">
              <picture>
                <source srcset="img/cmn/fixed_btn_sp.png" media="(max-width: 767px)" />
                <img src="img/cmn/fixed_btn.png" alt="今すぐ相場を確認する" />
              </picture>
            </button>
          </div>
        </div>
      </div>
      <!-- //fixed-area -->
    </div>
    <!-- // wrapper -->

    <!-- BOTコンテナ（estimate-keep-system統合） -->
    <!-- モバイル用固定プログレスバー -->
    <div id="mobileProgressBar" class="fixed top-0 left-0 right-0 bg-white shadow-sm z-50 md:hidden hidden">
        <div class="px-4 py-2 flex items-center justify-between">
            <span class="text-sm font-medium text-gray-700">進行度</span>
            <span id="mobileProgressPercentage" class="text-sm font-bold text-blue-600">0%</span>
        </div>
        <div class="h-1 bg-gray-200">
            <div id="mobileProgressBarFill" style="height: 100%; width: 0%; background: transparent; transition: all 0.3s;"></div>
        </div>
    </div>

    <div id="gaiheki-bot-container" style="display: none;">
    <!-- メインコンテンツ（BOT + ランキング） -->
    <div id="botParentContainer" class="w-full px-4 space-y-6 pb-40 pt-12 md:pt-0" style="max-width: 100vw; margin: 0; font-size: 16px;">
        <!-- 見積もりボタン（固定位置・白背景） -->
        <div id="estimateBtnContainer" class="fixed bottom-0 left-0 right-0 bg-white shadow-2xl border-t border-gray-200 py-4 z-[9999] hidden">
            <div class="max-w-6xl mx-auto px-4 text-center">
                <button onclick="showKeepModal();" class="bg-orange-400 hover:bg-orange-500 text-white font-bold py-4 px-20 rounded-full text-lg transition-all relative inline-flex items-center justify-center shadow-lg">
                    無料見積もり
                    <span class="notification-badge">0</span>
                </button>
            </div>
        </div>

        <!-- 相場表示 -->
        <div id="priceSection" class="hidden">
            <div class="bg-gradient-to-br from-blue-500 via-blue-600 to-purple-600 rounded-2xl shadow-xl p-1">
                <div class="bg-white rounded-xl p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                            <svg class="w-6 h-6 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            <span id="areaName">検索中...</span>
                        </h2>
                        <span class="bg-gradient-to-r from-blue-500 to-purple-600 text-white text-xs font-bold px-3 py-1 rounded-full">
                            AI診断済み
                        </span>
                    </div>

                    <div style="background: linear-gradient(135deg, #EFF6FF 0%, #F5F3FF 100%); border-radius: 20px; padding: 24px 16px; box-shadow: 0 20px 60px rgba(59, 130, 246, 0.15), 0 4px 12px rgba(0, 0, 0, 0.08);">
                        <div style="text-align: center;">
                            <p style="font-size: clamp(12px, 3vw, 15px); font-weight: 600; color: #4B5563; margin-bottom: 16px; letter-spacing: 0.02em;">
                                戸建て2階建て（延床30坪・築25年）の場合
                            </p>
                            <div style="display: flex; align-items: center; justify-content: center; gap: clamp(8px, 2vw, 14px); margin-bottom: 16px; flex-wrap: nowrap;">
                                <div style="font-size: clamp(32px, 7vw, 52px); font-weight: 700; background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; white-space: nowrap; letter-spacing: -0.01em; line-height: 1.1;">
                                    60万円
                                </div>
                                <span style="font-size: clamp(20px, 4.5vw, 36px); color: #9CA3AF; white-space: nowrap; font-weight: 400; line-height: 1.1;">〜</span>
                                <div style="font-size: clamp(32px, 7vw, 52px); font-weight: 700; background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; white-space: nowrap; letter-spacing: -0.01em; line-height: 1.1;">
                                    180万円
                                </div>
                            </div>

                            <p style="font-size: clamp(11px, 2.5vw, 13px); color: #6B7280; display: flex; align-items: center; justify-content: center; gap: 6px; font-weight: 500;">
                                <svg style="width: 14px; height: 14px; opacity: 0.7; flex-shrink: 0;" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                                </svg>
                                建物の状態・使用材料により価格は変動します
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BOT + ランキング -->
        <div id="mainContentContainer" class="hidden flex flex-col md:flex-row md:gap-6 md:space-y-0 space-y-6 md:h-[800px] relative mb-16">

            <!-- AIチャットボット (右側) -->
            <div id="chatSection" class="bg-white rounded-xl shadow-lg p-4 md:p-6 min-h-[500px] md:h-full md:w-1/2 order-1 md:order-2 overflow-y-auto">
                <div id="messages"></div>

                <!-- Choices area -->
                <div id="choices" class="choices-container space-y-2 mt-4"></div>

                <!-- Typing indicator -->
                <div id="typingIndicator" class="flex items-center text-gray-500 text-sm mt-4 hidden">
                    <div class="flex space-x-1 mr-2">
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                    </div>
                </div>
            </div>

            <!-- ランキングセクション -->
            <div id="rankingSection" class="hidden ranking-section bg-blue-50 rounded-xl shadow-lg p-2 md:p-3 relative md:w-1/2 order-2 md:order-1 md:h-full md:flex md:flex-col" data-theme="blue">
                <h2 id="rankingTitle" class="text-lg font-bold mb-3">おすすめ業者ランキング</h2>

                <!-- モザイク時のメッセージ -->
                <div id="mosaicMessage" class="absolute inset-0 flex items-center justify-center z-10 pointer-events-none">
                    <div class="bg-white rounded-lg p-8 text-center shadow-lg">
                        <div class="text-blue-500 mb-4">
                            <svg class="w-16 h-16 mx-auto" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <h3 class="text-base font-bold mb-3 text-blue-600 whitespace-nowrap">質問に答えるとランキング表示！</h3>
                        <div class="text-gray-600 mb-4 text-[10px] md:text-xs space-y-1">
                            <p class="flex items-start flex-nowrap">
                                <span class="text-green-500 mr-1 flex-shrink-0">✅</span>
                                <span class="whitespace-nowrap">AI診断で最適マッチング！</span>
                            </p>
                            <p class="flex items-start flex-nowrap">
                                <span class="text-green-500 mr-1 flex-shrink-0">✅</span>
                                <span class="whitespace-nowrap">実績データで信頼できる！</span>
                            </p>
                            <p class="flex items-start flex-nowrap">
                                <span class="text-green-500 mr-1 flex-shrink-0">✅</span>
                                <span class="whitespace-nowrap">4社まで無料見積もり可能！</span>
                            </p>
                        </div>
                        <!-- 進捗メーター -->
                        <div id="progressMeter" class="mb-4 hidden">
                            <div class="flex justify-end text-xs text-gray-500 mb-1">
                                <span id="progressPercentage">0%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div id="progressBar" style="height: 8px; border-radius: 9999px; width: 0%; background: transparent; transition: all 0.5s;"></div>
                            </div>
                            <p class="text-xs text-blue-600 mt-2 font-medium">AIチャットの質問に答えて下さい</p>
                        </div>
                    </div>
                </div>

                <!-- ランキング内容（モザイクをかける対象） -->
                <div id="rankingContent" class="mosaic relative md:flex-1 md:flex md:flex-col overflow-hidden">

                    <!-- 並び替えタブ -->
                    <div class="bg-white rounded-lg p-3 mb-4 shadow-sm">
                        <h3 class="text-sm font-bold mb-3 text-gray-800">並び替え</h3>
                        <div class="grid grid-cols-4 gap-2">
                            <button id="sortRecommended" onclick="changeSortType('recommended')" class="sort-btn sort-btn-active bg-gradient-to-br from-blue-300 to-blue-400 text-white py-2 px-2 rounded-lg text-xs font-bold flex flex-col items-center justify-center gap-1 h-16 min-h-16 shadow-md border-2 border-blue-400 transition-all duration-200 hover:shadow-lg hover:scale-105 cursor-pointer">
                                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
                                </svg>
                                <span class="whitespace-nowrap">おすすめ順</span>
                            </button>
                            <button id="sortCheap" onclick="changeSortType('cheap')" class="sort-btn bg-gray-50 border-2 border-gray-400 text-gray-700 py-2 px-2 rounded-lg text-xs font-semibold flex flex-col items-center justify-center gap-1 h-16 min-h-16 shadow-md transition-all duration-200 hover:border-orange-400 hover:shadow-lg hover:scale-105 cursor-pointer">
                                <svg class="w-5 h-5 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span class="whitespace-nowrap">安い順</span>
                            </button>
                            <button id="sortReview" onclick="changeSortType('review')" class="sort-btn bg-gray-50 border-2 border-gray-400 text-gray-700 py-2 px-2 rounded-lg text-xs font-semibold flex flex-col items-center justify-center gap-1 h-16 min-h-16 shadow-md transition-all duration-200 hover:border-green-400 hover:shadow-lg hover:scale-105 cursor-pointer">
                                <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                                </svg>
                                <span class="whitespace-nowrap">口コミ順</span>
                            </button>
                            <button id="sortQuality" onclick="changeSortType('quality')" class="sort-btn bg-gray-50 border-2 border-gray-400 text-gray-700 py-2 px-2 rounded-lg text-xs font-semibold flex flex-col items-center justify-center gap-1 h-16 min-h-16 shadow-md transition-all duration-200 hover:border-purple-400 hover:shadow-lg hover:scale-105 cursor-pointer">
                                <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
                                </svg>
                                <span class="whitespace-nowrap">高品質順</span>
                            </button>
                        </div>
                    </div>

                    <!-- ランキングリスト -->
                    <div id="rankingList" class="space-y-1.5 pb-4 max-h-[550px] overflow-y-auto">
                        <!-- ranking.jsのdisplayRanking()によって動的生成 -->
                    </div>                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                </div>
            </div>
        </div>
    </div>

    <!-- フッター -->
    <footer style="padding: 33px 0 16px; text-align: center; color: #fff; background: linear-gradient(135deg, #3B82F6, #2563EB);">
        <small style="font-size: 12px; display: block; font-weight: 400;">&copy;外壁塗装くらべる All Rights Reserved.</small>
    </footer>

    <!-- キープ確認モーダル -->
    <div id="keepModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-[2000] flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <h2 class="text-xl font-bold mb-4">見積もりの流れ</h2>

                <!-- YouTube動画 -->
                <div class="mb-4">
                    <div class="flex justify-center">
                        <div class="relative w-full max-w-xs">
                            <div class="relative" style="padding-bottom: 56.25%;">
                                <iframe class="absolute top-0 left-0 w-full h-full rounded-lg"
                                        src="https://www.youtube.com/embed/dQw4w9WgXcQ"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen></iframe>
                            </div>
                        </div>
                    </div>
                </div>

                <h3 class="text-lg font-bold mb-3">キープ中の業者</h3>
                <div id="keepList" class="space-y-2 mb-4">
                    <!-- キープリストがここに表示 -->
                </div>

                <div class="flex gap-2">
                    <button onclick="closeKeepModal()" class="px-6 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold">
                        閉じる
                    </button>
                    <button onclick="startEstimateForm()" class="flex-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-lg font-bold">
                        この業者の見積もりを見てみる
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 見積もりフォームモーダル -->
    <div id="estimateFormModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-[2000] flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <!-- プログレスバー -->
            <div class="bg-gray-100 p-4 border-b">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-medium text-gray-700">ステップ <span id="currentStep">1</span> / 2</span>
                    <span class="text-sm font-medium text-blue-600"><span id="stepPercent">50</span>%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="stepProgress" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 50%"></div>
                </div>
            </div>

            <!-- ステップ1: 基本情報 -->
            <div id="step1" class="p-6">
                <h2 class="text-xl font-bold mb-4">基本情報の入力</h2>

                <!-- お名前 -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        お名前 <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="userName" class="w-full border-2 border-gray-200 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500" placeholder="山田 太郎">
                </div>

                <!-- 対象物件住所 -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        対象物件住所 <span class="text-red-500">*</span>
                    </label>
                    <div class="space-y-2">
                        <div class="flex gap-2">
                            <input type="text" id="propertyZip" class="w-32 border-2 border-gray-200 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500" placeholder="000-0000" readonly>
                            <input type="text" id="propertyAddress" class="flex-1 border-2 border-gray-200 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500" placeholder="市区町村" readonly>
                        </div>
                        <input type="text" id="propertyStreet" class="w-full border-2 border-gray-200 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500" placeholder="番地・建物名">
                    </div>
                </div>

                <!-- 自宅住所（条件付き） -->
                <div class="mb-4">
                    <label class="flex items-center">
                        <input type="checkbox" id="differentHome" class="mr-2" onchange="toggleHomeAddress()">
                        <span class="text-sm font-medium text-gray-700">対象物件と自宅が異なる場合はチェック</span>
                    </label>

                    <div id="homeAddressSection" class="hidden mt-3 space-y-2">
                        <div class="flex gap-2">
                            <input type="text" id="homeZip" class="w-32 border-2 border-gray-200 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500" placeholder="000-0000">
                            <input type="text" id="homeAddress" class="flex-1 border-2 border-gray-200 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500" placeholder="市区町村" readonly>
                        </div>
                        <input type="text" id="homeStreet" class="w-full border-2 border-gray-200 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500" placeholder="番地・建物名">
                    </div>
                </div>

                <!-- メールアドレス（任意） -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        メールアドレス <span class="text-gray-400">(任意)</span>
                    </label>
                    <input type="email" id="userEmail" class="w-full border-2 border-gray-200 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500" placeholder="example@email.com">
                </div>

                <div class="flex gap-2">
                    <button onclick="closeEstimateForm()" class="px-6 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold">
                        戻る
                    </button>
                    <button onclick="nextStep()" class="flex-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-lg font-bold">
                        次へ
                    </button>
                </div>
            </div>

            <!-- ステップ2: 詳細情報 -->
            <div id="step2" class="p-6 hidden">
                <h2 class="text-xl font-bold mb-4">詳細情報の入力</h2>

                <!-- 現地調査希望日時 -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        現地調査希望日時 <span class="text-gray-400">(複数選択可)</span>
                    </label>
                    <div class="space-y-2" id="surveyDates">
                        <!-- 動的に生成 -->
                    </div>
                </div>

                <!-- その他ご要望 -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        その他ご要望・ご相談 <span class="text-gray-400">(任意)</span>
                    </label>
                    <textarea id="requests" rows="4" class="w-full border-2 border-gray-200 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500" placeholder="ご要望やご相談があればご記入ください"></textarea>
                </div>

                <div class="flex gap-2">
                    <button onclick="prevStep()" class="px-6 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold">
                        戻る
                    </button>
                    <button id="submitBtn" onclick="submitEstimateForm()" class="flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-lg font-bold">
                        送信する
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!--java script-->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <!-- <script src="js/delay_anim.js"></script> -->
    <script src="js/function.js"></script>
    <script src="js/validate.js"></script>
    <!--//java script-->

    <!-- BOT用ヘルパー関数 -->
    <script>
        // スクロール関数
        function scrollToBotBottom() {
            const messages = document.getElementById('messages');
            if (messages) {
                messages.scrollTop = messages.scrollHeight;
            }
        }

        // 電話番号入力ミニフォーム表示
        function showPhoneMiniForm() {
            const messages = document.getElementById('messages');
            if (!messages) return;

            // フォームを作成（メッセージはzip-word-bot.jsonから表示済み）
            setTimeout(() => {
                const formContainer = document.createElement('div');
                formContainer.className = 'phone-mini-form';
                formContainer.innerHTML = `
                    <div class="waiting-animation">
                        <img src="images/elderly-1.png" alt="待機中1" class="waiting-character">
                        <img src="images/elderly-2.png" alt="待機中2" class="waiting-character">
                        <img src="images/elderly-3.png" alt="待機中3" class="waiting-character">
                    </div>
                    <div class="form-title">
                        電話番号（ショートメッセージ）
                    </div>
                    <div class="phone-input-wrapper">
                        <input type="tel" id="phoneInput" class="phone-input"
                               placeholder="08012345678"
                               maxlength="11"
                               inputmode="numeric"
                               pattern="[0-9]*">
                    </div>
                    <div class="phone-error" id="phoneError">
                        正しい電話番号を入力してください
                    </div>
                    <button id="phoneSubmitBtn" class="phone-submit-btn" disabled>
                        結果を受け取る
                    </button>
                `;
                messages.appendChild(formContainer);

                // イベントリスナー設定
                setupPhoneFormListeners();

                // フォームにスクロール（DOMレイアウト更新後に実行）
                setTimeout(() => {
                    formContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 100);
            }, 500);
        }

        // 電話番号フォームのイベントリスナー設定
        function setupPhoneFormListeners() {
            const phoneInput = document.getElementById('phoneInput');
            const submitBtn = document.getElementById('phoneSubmitBtn');
            const phoneError = document.getElementById('phoneError');

            if (!phoneInput || !submitBtn || !phoneError) return;

            // 入力イベント
            phoneInput.addEventListener('input', function(e) {
                // 数字のみ許可
                this.value = this.value.replace(/[^0-9]/g, '');

                // バリデーション
                if (validatePhone(this.value)) {
                    submitBtn.disabled = false;
                    phoneError.classList.remove('show');
                } else {
                    submitBtn.disabled = true;
                    if (this.value.length >= 10) {
                        phoneError.classList.add('show');
                    }
                }
            });

            // 送信ボタンクリック
            submitBtn.addEventListener('click', function() {
                const phone = phoneInput.value;
                if (validatePhone(phone)) {
                    submitPhoneNumber(phone);
                }
            });

            // Enterキーで送信
            phoneInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !submitBtn.disabled) {
                    submitBtn.click();
                }
            });
        }

        // 電話番号バリデーション
        function validatePhone(phone) {
            return /^0[0-9]{9,10}$/.test(phone);
        }

        // 電話番号送信処理
        function submitPhoneNumber(phone) {
            // 電話番号を保存
            localStorage.setItem('userPhone', phone);

            // フォームを非表示
            const formElements = document.querySelectorAll('.phone-mini-form');
            formElements.forEach(el => {
                el.style.opacity = '0.5';
                const btn = el.querySelector('button');
                const input = el.querySelector('input');
                if (btn) btn.disabled = true;
                if (input) input.disabled = true;
            });

            // 完了メッセージ表示とランキング解除
            setTimeout(() => {
                const messages = document.getElementById('messages');

                // モザイクを解除
                const rankingContent = document.getElementById('rankingContent');
                const mosaicMessage = document.getElementById('mosaicMessage');
                if (rankingContent) rankingContent.classList.remove('mosaic');
                if (mosaicMessage) mosaicMessage.style.display = 'none';

                // 完了メッセージ（選択したソート順に応じたメッセージ）
                const sortTypeMessages = {
                    'cheap': 'ありがとうございます！「安い順」ランキングなどを参考にしながら業者を選択してください。',
                    'review': 'ありがとうございます！「口コミ順」ランキングなどを参考にしながら業者を選択してください。',
                    'quality': 'ありがとうございます！「高品質順」ランキングなどを参考にしながら業者を選択してください。',
                    'recommended': 'ありがとうございます！「おすすめ順」ランキングなどを参考にしながら業者を選択してください。'
                };
                const selectedSortType = (window.BotConfig && window.BotConfig.state && window.BotConfig.state.selectedSortType) || 'recommended';
                const completionMessage = sortTypeMessages[selectedSortType] || sortTypeMessages['recommended'];

                const aiMessageContainer = document.createElement('div');
                aiMessageContainer.className = 'ai-message-container';
                aiMessageContainer.innerHTML = `
                    <img src="images/avatars/319260ba-0b3d-47d0-b18f-abf530c2793e.png" alt="AI" class="ai-avatar" loading="eager" decoding="async">
                    <div class="ai-message">
                        ${completionMessage}
                    </div>
                `;
                messages.appendChild(aiMessageContainer);
                scrollToBotBottom();

                // スマホ版の場合はランキングセクションまでスクロール
                if (window.innerWidth < 768) {
                    setTimeout(() => {
                        const rankingSection = document.getElementById('rankingSection');
                        if (rankingSection) {
                            rankingSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }, 500);
                }

                updateProgress(100);
            }, 1000);
        }

        // 進捗更新
        function updateProgress(percentage) {
            // デスクトップ版
            const progressPercentage = document.getElementById('progressPercentage');
            const progressBar = document.getElementById('progressBar');
            if (progressPercentage) progressPercentage.textContent = percentage + '%';
            if (progressBar) {
                progressBar.style.width = percentage + '%';
                progressBar.style.background = 'linear-gradient(90deg, #3B82F6 0%, #60A5FA 100%)';
            }

            // モバイル版
            const mobileProgressPercentage = document.getElementById('mobileProgressPercentage');
            const mobileProgressBar = document.getElementById('mobileProgressBarFill');
            if (mobileProgressPercentage) mobileProgressPercentage.textContent = percentage + '%';
            if (mobileProgressBar) {
                mobileProgressBar.style.width = percentage + '%';
                mobileProgressBar.style.background = 'linear-gradient(90deg, #3B82F6 0%, #60A5FA 100%)';
            }
        }

        // ランキングソート切り替え
        function changeSortType(type) {
            const rankingSection = document.getElementById('rankingSection');
            const rankingTitle = document.getElementById('rankingTitle');

            // 非選択時の基本クラス
            const baseClass = 'sort-btn bg-gray-50 border-2 border-gray-400 text-gray-700 py-2 px-2 rounded-lg text-xs font-semibold flex flex-col items-center justify-center gap-1 h-16 min-h-16 shadow-md transition-all duration-200 cursor-pointer';

            // すべてのボタンをリセット
            document.getElementById('sortRecommended').className = baseClass + ' hover:border-blue-400 hover:shadow-lg hover:scale-105';
            document.getElementById('sortCheap').className = baseClass + ' hover:border-orange-400 hover:shadow-lg hover:scale-105';
            document.getElementById('sortReview').className = baseClass + ' hover:border-green-400 hover:shadow-lg hover:scale-105';
            document.getElementById('sortQuality').className = baseClass + ' hover:border-purple-400 hover:shadow-lg hover:scale-105';

            // アイコンの色を各ボタンのテーマカラーに設定（非選択時）
            document.getElementById('sortRecommended').querySelector('svg').setAttribute('stroke', '#2563eb');
            document.getElementById('sortCheap').querySelector('svg').setAttribute('stroke', '#ea580c');
            document.getElementById('sortReview').querySelector('svg').setAttribute('stroke', '#16a34a');
            document.getElementById('sortQuality').querySelector('svg').setAttribute('stroke', '#9333ea');

            // テーマカラーとタイトルを変更（パステル調）
            switch(type) {
                case 'recommended':
                    document.getElementById('sortRecommended').className = 'sort-btn sort-btn-active bg-gradient-to-br from-blue-300 to-blue-400 text-white py-2 px-2 rounded-lg text-xs font-bold flex flex-col items-center justify-center gap-1 h-16 min-h-16 shadow-md border-2 border-blue-400 transition-all duration-200 hover:shadow-lg hover:scale-105 cursor-pointer';
                    document.getElementById('sortRecommended').querySelector('svg').setAttribute('stroke', '#ffffff');
                    rankingSection.setAttribute('data-theme', 'blue');
                    rankingTitle.textContent = 'おすすめ業者ランキング';
                    break;
                case 'cheap':
                    document.getElementById('sortCheap').className = 'sort-btn sort-btn-active bg-gradient-to-br from-orange-300 to-orange-400 text-white py-2 px-2 rounded-lg text-xs font-bold flex flex-col items-center justify-center gap-1 h-16 min-h-16 shadow-md border-2 border-orange-400 transition-all duration-200 hover:shadow-lg hover:scale-105 cursor-pointer';
                    document.getElementById('sortCheap').querySelector('svg').setAttribute('stroke', '#ffffff');
                    rankingSection.setAttribute('data-theme', 'orange');
                    rankingTitle.textContent = 'コスパ上位ランキング';
                    break;
                case 'review':
                    document.getElementById('sortReview').className = 'sort-btn sort-btn-active bg-gradient-to-br from-green-300 to-green-400 text-white py-2 px-2 rounded-lg text-xs font-bold flex flex-col items-center justify-center gap-1 h-16 min-h-16 shadow-md border-2 border-green-400 transition-all duration-200 hover:shadow-lg hover:scale-105 cursor-pointer';
                    document.getElementById('sortReview').querySelector('svg').setAttribute('stroke', '#ffffff');
                    rankingSection.setAttribute('data-theme', 'green');
                    rankingTitle.textContent = 'クチコミスコアランキング';
                    break;
                case 'quality':
                    document.getElementById('sortQuality').className = 'sort-btn sort-btn-active bg-gradient-to-br from-purple-300 to-purple-400 text-white py-2 px-2 rounded-lg text-xs font-bold flex flex-col items-center justify-center gap-1 h-16 min-h-16 shadow-md border-2 border-purple-400 transition-all duration-200 hover:shadow-lg hover:scale-105 cursor-pointer';
                    document.getElementById('sortQuality').querySelector('svg').setAttribute('stroke', '#ffffff');
                    rankingSection.setAttribute('data-theme', 'purple');
                    rankingTitle.textContent = '高品質保証ランキング';
                    break;
            }
        }

        // キープ管理クラス
        class KeepManager {
            constructor() {
                // リロード時は常に空の状態から開始
                localStorage.removeItem('keeps');
                this.keeps = [];
            }

            toggle(id, name, button) {
                console.log('🔄 toggle呼び出し - ID:', id, 'Name:', name);
                const keepData = { id, name };
                const index = this.keeps.findIndex(k => k.id === id);

                if (index > -1) {
                    console.log('❌ キープ削除:', name);
                    this.keeps.splice(index, 1);
                    button.classList.remove('active');
                } else {
                    // 4社までの制限
                    if (this.keeps.length >= 4) {
                        alert('キープは最大4社までです');
                        console.warn('⚠️ キープ上限に達しました');
                        return;
                    }
                    console.log('✅ キープ追加:', name);
                    this.keeps.push(keepData);
                    button.classList.add('active');
                }

                console.log('📊 現在のキープリスト:', this.keeps);
                this.save();
                this.updateBadge();
            }

            save() {
                localStorage.setItem('keeps', JSON.stringify(this.keeps));
            }

            updateBadge() {
                console.log('🔔 updateBadge呼び出し - キープ数:', this.keeps.length);
                const badges = document.querySelectorAll('.notification-badge');
                const estimateBtnContainer = document.getElementById('estimateBtnContainer');
                console.log('📍 estimateBtnContainer:', estimateBtnContainer);
                console.log('📍 estimateBtnContainer存在:', !!estimateBtnContainer);

                if (estimateBtnContainer) {
                    console.log('📍 現在のdisplayスタイル:', window.getComputedStyle(estimateBtnContainer).display);
                    console.log('📍 現在のhiddenクラス:', estimateBtnContainer.classList.contains('hidden'));
                }

                badges.forEach(badge => {
                    badge.textContent = this.keeps.length;
                    console.log('🔔 バッジ更新:', badge, '→', this.keeps.length);
                });

                if (estimateBtnContainer) {
                    if (this.keeps.length > 0) {
                        console.log('✅ 見積もりボタンを表示');
                        estimateBtnContainer.classList.remove('hidden');
                        estimateBtnContainer.style.display = 'block';
                    } else {
                        console.log('❌ 見積もりボタンを非表示');
                        estimateBtnContainer.classList.add('hidden');
                        estimateBtnContainer.style.display = 'none';
                    }
                } else {
                    console.error('❌ estimateBtnContainerが見つかりません');
                }
            }

            updateUI() {
                this.updateBadge();

                // キープボタンの状態を更新
                document.querySelectorAll('.keep-btn').forEach(btn => {
                    const onclickAttr = btn.getAttribute('onclick');
                    if (onclickAttr) {
                        const match = onclickAttr.match(/'([^']+)'/);
                        if (match) {
                            const btnId = match[1];
                            const isKept = this.keeps.some(k => k.id === btnId);
                            if (isKept) {
                                btn.classList.add('active');
                            } else {
                                btn.classList.remove('active');
                            }
                        }
                    }
                });
            }

            getList() {
                return this.keeps;
            }
        }

        // キープマネージャーのインスタンス化
        const keepManager = new KeepManager();

        // モーダル表示
        function showKeepModal() {
            const modal = document.getElementById('keepModal');
            const keepList = document.getElementById('keepList');
            const keeps = keepManager.getList();

            // キ���プリストを表示
            keepList.innerHTML = keeps.map(keep => `
                <div class="p-3 border rounded-lg flex items-center justify-between">
                    <span class="font-medium">${keep.name}</span>
                    <span class="text-sm text-gray-500">キープ中</span>
                </div>
            `).join('');

            modal.classList.remove('hidden');
        }

        // モーダルを閉じる
        function closeKeepModal() {
            document.getElementById('keepModal').classList.add('hidden');
        }

        // 見積もりフォームを開始（※2160行目に詳細版があるため、ここでは定義しない）

        // 見積もりフォームを閉じる
        function closeEstimateForm() {
            document.getElementById('estimateFormModal').classList.add('hidden');
            // ステップを1に戻す
            document.getElementById('step1').classList.remove('hidden');
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('currentStep').textContent = '1';
            document.getElementById('stepPercent').textContent = '50';
            document.getElementById('stepProgress').style.width = '50%';
        }

        // 郵便番号から住所を取得
        async function fetchAddress(postalCode, type) {
            if (!postalCode) return;

            // 郵便番号から住所を取得
            if (typeof window.getAreaFromPostalCode === 'function') {
                const areaInfo = window.getAreaFromPostalCode(postalCode);

                // 都道府県と市区町村に分割
                const prefectureMatch = areaInfo.match(/(.*?[都道府県])(.*)/);

                if (type === 'home') {
                    const homeAddressField = document.getElementById('homeAddress');
                    if (homeAddressField) {
                        homeAddressField.value = areaInfo;
                    }

                    if (prefectureMatch) {
                        window.homePrefecture = prefectureMatch[1];
                        console.log('✅ 自宅住所を保存:', {
                            prefecture: window.homePrefecture,
                            fullAddress: areaInfo
                        });
                    } else {
                        window.homePrefecture = '';
                    }
                }
            }
        }

        // 自宅住所の表示切り替え
        function toggleHomeAddress() {
            const checkbox = document.getElementById('differentHome');
            const homeAddressFields = document.getElementById('homeAddressSection');
            if (checkbox.checked) {
                homeAddressFields.classList.remove('hidden');
            } else {
                homeAddressFields.classList.add('hidden');
            }
        }

        // nextStep と prevStep は2234行目以降に詳細版で定義されています

        // 現地調査希望日時を動的生成（曜日+時間帯形式）
        function generateSurveyDates() {
            const container = document.getElementById('surveyDates');

            // 曜日と時間帯のオプション
            const options = [
                { value: '月曜_午前', label: '月曜日 午前' },
                { value: '月曜_午後', label: '月曜日 午後' },
                { value: '火曜_午前', label: '火曜日 午前' },
                { value: '火曜_午後', label: '火曜日 午後' },
                { value: '水曜_午前', label: '水曜日 午前' },
                { value: '水曜_午後', label: '水曜日 午後' },
                { value: '木曜_午前', label: '木曜日 午前' },
                { value: '木曜_午後', label: '木曜日 午後' },
                { value: '金曜_午前', label: '金曜日 午前' },
                { value: '金曜_午後', label: '金曜日 午後' },
                { value: '土曜_午前', label: '土曜日 午前' },
                { value: '土曜_午後', label: '土曜日 午後' },
                { value: '日曜_午前', label: '日曜日 午前' },
                { value: '日曜_午後', label: '日曜日 午後' },
                { value: '未定', label: '未定' }
            ];

            // チェックボックスを生成（午前と午後を横並びに）
            let html = '';
            for (let i = 0; i < options.length - 1; i += 2) {
                html += `<div class="grid grid-cols-2 gap-2">`;
                html += `
                    <label class="flex items-center space-x-2 p-2 border rounded-lg hover:bg-gray-50 cursor-pointer">
                        <input type="checkbox" name="surveyDate" value="${options[i].value}" class="form-checkbox">
                        <span class="text-sm">${options[i].label}</span>
                    </label>
                `;
                if (i + 1 < options.length - 1) {
                    html += `
                        <label class="flex items-center space-x-2 p-2 border rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" name="surveyDate" value="${options[i + 1].value}" class="form-checkbox">
                            <span class="text-sm">${options[i + 1].label}</span>
                        </label>
                    `;
                }
                html += `</div>`;
            }

            // 未定は別枠で表示
            html += `
                <label class="flex items-center space-x-2 p-2 border rounded-lg hover:bg-gray-50 cursor-pointer">
                    <input type="checkbox" name="surveyDate" value="未定" class="form-checkbox">
                    <span class="text-sm">未定</span>
                </label>
            `;

            container.innerHTML = html;
        }

        // 見積もりフォーム送信
        async function submitEstimateForm() {
            console.log('📝 見積もりフォーム送信開始');

            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = '送信中...';

            try {
                // フォームデータ取得
                const formData = {
                    name: document.getElementById('userName').value.trim(),
                    propertyZip: document.getElementById('propertyZip').value.trim(),
                    propertyAddress: document.getElementById('propertyAddress').value.trim(),
                    propertyStreet: document.getElementById('propertyStreet').value.trim(),
                    email: document.getElementById('userEmail').value.trim(),
                    requests: document.getElementById('requests').value.trim(),
                    surveyDates: Array.from(document.querySelectorAll('input[name="surveyDate"]:checked')).map(cb => cb.value),
                    keptCompanies: keepManager.getList().map(k => k.name),
                    botAnswers: window.BotConfig ? window.BotConfig.state.userAnswers : {}
                };

                // 自宅住所（異なる場合）
                if (document.getElementById('differentHome').checked) {
                    formData.homeZip = document.getElementById('homeZip').value.trim();
                    formData.homeAddress = document.getElementById('homeAddress').value.trim();
                    formData.homeStreet = document.getElementById('homeStreet').value.trim();
                }

                console.log('📤 送信データ:', formData);

                // CV2フォーマットに変換
                const cv2FormData = {
                    name: formData.name,
                    email: formData.email,
                    propertyAddress: { postalCode: formData.propertyZip, street: formData.propertyStreet },
                    isDifferentHome: formData.homeZip ? true : false,
                    homeAddress: formData.homeZip ? { postalCode: formData.homeZip, street: formData.homeStreet } : null,
                    surveyDates: formData.surveyDates,
                    requests: formData.requests
                };

                // GASへ送信（CV2として送信）
                if (window.CVAPI && window.CVAPI.sendCV2) {
                    const response = await window.CVAPI.sendCV2(cv2FormData);
                    if (response.success) {
                        console.log('✅ CV2送信成功');
                        showCompletionScreen();
                    } else {
                        console.error('❌ CV2送信失敗:', response.error);
                        alert('送信に失敗しま���た。もう一度お試しください。');
                    }
                } else {
                    console.error('❌ CVAPI.sendCV2が見つかりません');
                    alert('送信機能が利用できません。ページをリロードしてください。');
                }
            } catch (error) {
                console.error('❌ 送信エラー:', error);
                alert('送信中にエラーが発生しました。');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = '送信する';
            }
        }

        // ============================================
        // 見積もりフォーム関連
        // ============================================
        function startEstimateForm() {
            console.log('📝 見積もりフォーム開始');

            // キープモーダルを閉じる
            closeKeepModal();

            // 見積もりフォームモーダルを表示
            const modal = document.getElementById('estimateFormModal');
            if (modal) {
                modal.classList.remove('hidden');

                // BOT情報から郵便番号と住所を自動入力
                if (window.BotConfig && window.BotConfig.state) {
                    const zipcode = window.BotConfig.state.currentZipcode;
                    if (zipcode) {
                        document.getElementById('propertyZip').value = zipcode;

                        // 郵便番号から住所を取得
                        if (typeof window.getAreaFromPostalCode === 'function') {
                            const area = window.getAreaFromPostalCode(zipcode);
                            document.getElementById('propertyAddress').value = area || '';
                        }
                    }
                }

                console.log('✅ 見積もりフォーム表示');
            } else {
                console.error('❌ estimateFormModalが見つかりません');
            }
        }

        // 完了画面を表示
        function showCompletionScreen() {
            const modal = document.getElementById('estimateFormModal');
            if (!modal) return;

            modal.innerHTML = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[3000]">
                    <div class="bg-white rounded-lg max-w-md w-full p-6">
                        <div class="text-center">
                            <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-10 h-10 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <h2 class="text-2xl font-bold mb-2">送信完了しました！</h2>
                            <p class="text-gray-600 mb-4">
                                見積もり依頼を受け付けました。
                            </p>
                            <div class="bg-orange-50 border border-orange-300 p-4 rounded-lg mb-4">
                                <p class="font-semibold text-orange-800 mb-2">重要なお知らせ</p>
                                <p class="text-sm text-gray-700 mb-2">
                                    弊社オペレーターから簡単なご本人様確認のお電話が入りますのでご対応お願いいたします。
                                </p>
                                <p class="text-sm font-semibold text-gray-800">
                                    担当：山内
                                </p>
                                <p class="text-lg font-bold text-orange-800">
                                    電話番号：090-1994-7162
                                </p>
                            </div>
                            <div class="text-left bg-blue-50 p-4 rounded-lg mb-6">
                                <p class="font-semibold mb-2">今後の流れ</p>
                                <ol class="text-sm space-y-1">
                                    <li>1. 業者から連絡が入ります</li>
                                    <li>2. 現地調査の日程を調整</li>
                                    <li>3. 正式な見積もりをご提出</li>
                                </ol>
                            </div>
                            <button onclick="location.reload();" class="bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition w-full font-bold">
                                閉じる
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function closeEstimateForm() {
            console.log('📝 見積もりフォーム閉じる');
            const modal = document.getElementById('estimateFormModal');
            if (modal) {
                modal.classList.add('hidden');
                // ステップ1に戻す
                document.getElementById('step1').classList.remove('hidden');
                document.getElementById('step2').classList.add('hidden');
            }
        }

        function nextStep() {
            console.log('📝 次のステップへ');

            // バリデーション
            const userName = document.getElementById('userName').value.trim();
            const propertyStreet = document.getElementById('propertyStreet').value.trim();

            if (!userName) {
                alert('お名前を入力してください');
                return;
            }

            if (!propertyStreet) {
                alert('対象物件の番地・建物名を入力してください');
                return;
            }

            // ステップ2へ
            document.getElementById('step1').classList.add('hidden');
            document.getElementById('step2').classList.remove('hidden');

            // プログレスバー更新
            document.getElementById('currentStep').textContent = '2';
            document.getElementById('stepPercent').textContent = '100';
            document.getElementById('stepProgress').style.width = '100%';

            // 現地調査希望日時の選択肢を生成
            generateSurveyDates();
        }

        function prevStep() {
            console.log('📝 前のステップへ');
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step1').classList.remove('hidden');

            // プログレスバー更新
            document.getElementById('currentStep').textContent = '1';
            document.getElementById('stepPercent').textContent = '50';
            document.getElementById('stepProgress').style.width = '50%';
        }

        function generateSurveyDates() {
            const container = document.getElementById('surveyDates');
            if (!container) return;

            // 曜日と時間帯のオプション
            const options = [
                { value: '月曜_午前', label: '月曜日 午前' },
                { value: '月曜_午後', label: '月曜日 午後' },
                { value: '火曜_午前', label: '火曜日 午前' },
                { value: '火曜_午後', label: '火曜日 午後' },
                { value: '水曜_午前', label: '水曜日 午前' },
                { value: '水曜_午後', label: '水曜日 午後' },
                { value: '木曜_午前', label: '木曜日 午前' },
                { value: '木曜_午後', label: '木曜日 午後' },
                { value: '金曜_午前', label: '金曜日 午前' },
                { value: '金曜_午後', label: '金曜日 午後' },
                { value: '土曜_午前', label: '土曜日 午前' },
                { value: '土曜_午後', label: '土曜日 午後' },
                { value: '日曜_午前', label: '日曜日 午前' },
                { value: '日曜_午後', label: '日曜日 午後' },
                { value: '未定', label: '未定' }
            ];

            // チェックボックスを生成（午前と午後を横並びに）
            let html = '';
            for (let i = 0; i < options.length - 1; i += 2) {
                html += `<div class="grid grid-cols-2 gap-2">`;
                html += `
                    <label class="flex items-center space-x-2 p-2 border rounded-lg hover:bg-gray-50 cursor-pointer">
                        <input type="checkbox" name="surveyDate" value="${options[i].value}" class="form-checkbox">
                        <span class="text-sm">${options[i].label}</span>
                    </label>
                `;
                if (i + 1 < options.length - 1) {
                    html += `
                        <label class="flex items-center space-x-2 p-2 border rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" name="surveyDate" value="${options[i + 1].value}" class="form-checkbox">
                            <span class="text-sm">${options[i + 1].label}</span>
                        </label>
                    `;
                }
                html += `</div>`;
            }

            // 未定は別枠で表示
            html += `
                <label class="flex items-center space-x-2 p-2 border rounded-lg hover:bg-gray-50 cursor-pointer">
                    <input type="checkbox" name="surveyDate" value="未定" class="form-checkbox">
                    <span class="text-sm">未定</span>
                </label>
            `;

            container.innerHTML = html;
        }

        async function submitForm() {
            console.log('📝 フォーム送信開始');

            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = '送信中...';

            try {
                // フォームデータを収集
                const formData = {
                    name: document.getElementById('userName').value.trim(),
                    email: document.getElementById('userEmail').value.trim(),
                    propertyAddress: {
                        postalCode: document.getElementById('propertyZip').value,
                        prefecture: document.getElementById('propertyAddress').value,
                        street: document.getElementById('propertyStreet').value.trim()
                    },
                    isDifferentHome: document.getElementById('differentHome').checked,
                    homeAddress: document.getElementById('differentHome').checked ? {
                        postalCode: document.getElementById('homeZip').value,
                        street: document.getElementById('homeStreet').value.trim()
                    } : null,
                    surveyDates: Array.from(document.querySelectorAll('input[name="surveyDate"]:checked')).map(cb => cb.value),
                    requests: document.getElementById('userRequests')?.value || ''
                };

                console.log('📤 送信データ:', formData);

                // CVAPI.sendCV2を呼び出し
                if (window.CVAPI && typeof window.CVAPI.sendCV2 === 'function') {
                    const response = await window.CVAPI.sendCV2(formData);

                    if (response.success) {
                        console.log('✅ CV2送信成功');
                        alert('送信が完了しました！業者から連絡が届きます。');
                        closeEstimateForm();
                    } else {
                        console.error('❌ CV2送信失敗:', response.error);
                        alert('送信に失敗しました。もう一度お試しください。');
                    }
                } else {
                    console.error('❌ CVAPI.sendCV2が見つかりません');
                    alert('送信機能が利用できません。');
                }

            } catch (error) {
                console.error('❌ フォーム送信エラー:', error);
                alert('エラーが発生しました。もう一度お試しください。');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = '送信する';
            }
        }

        function toggleHomeAddress() {
            const checkbox = document.getElementById('differentHome');
            const section = document.getElementById('homeAddressSection');

            if (checkbox.checked) {
                section.classList.remove('hidden');
            } else {
                section.classList.add('hidden');
            }
        }

        // フォーム送信の連打防止とローディング表示
        document.addEventListener('DOMContentLoaded', function() {
            let isSubmitting = false; // 送信中フラグ

            const form = document.querySelector('.km_form');
            const submitBtn = document.getElementById('analy-form_btn01');
            const loadingOverlay = document.getElementById('form-loading-overlay');

            if (form && submitBtn && loadingOverlay) {
                form.addEventListener('submit', function(e) {
                    // 既に送信中の場合は送信をキャンセル
                    if (isSubmitting) {
                        e.preventDefault();
                        console.log('フォーム送信: 既に送信中のため、送信をキャンセルしました');
                        return false;
                    }

                    // 一旦送信をキャンセルして、バリデーション結果を確認
                    e.preventDefault();

                    // validate.jsのバリデーション実行を待つ
                    setTimeout(function() {
                        // バリデーションエラーがある場合はローディングを表示しない
                        const hasValidationError = form.querySelector('.km_valid_error') !== null;

                        if (hasValidationError) {
                            console.log('フォーム送信: バリデーションエラーがあります');
                            return;
                        }

                        // バリデーション成功：送信処理開始
                        isSubmitting = true;

                        // ボタンを無効化
                        submitBtn.disabled = true;
                        submitBtn.style.opacity = '0.6';
                        submitBtn.style.cursor = 'not-allowed';

                        // ローディングオーバーレイを表示
                        loadingOverlay.style.display = 'flex';

                        console.log('フォーム送信: 送信処理を開始しました');

                        // フォームを手動で送信
                        form.submit();
                    }, 100); // validate.jsの処理を待つための遅延
                });
            }
        });
    </script>

    <!-- 外壁塗装くらべる BOTシステム -->
    <!-- 環境変数を最初にロード（GAS URL設定） -->
    <script src="js/env-loader.js?v=1762596120000"></script>
    <script src="gaiheki-bot-loader.js?v=1762596120000"></script>
  </body>
</html>
